<template><h1 id="application-todo-liste" tabindex="-1"><a class="header-anchor" href="#application-todo-liste" aria-hidden="true">#</a> Application Todo Liste</h1>
<h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h2>
<p>Dans ce TP nous allons rÃ©aliser une application / site web, le but de cette application / site web est de faire de la prise de note de Â« TODO Â» ou aussi appelÃ©e liste de tÃ¢ches.</p>
<p>Une TODO List est un procÃ©dÃ© qui se veut simple et efficace pour gÃ©rer les tÃ¢ches d'un projet. Ces tÃ¢ches peuvent Ãªtre indÃ©pendantes ou devoir, au contraire, Ãªtre accomplies dans un certain ordre.</p>
<p>VoilÃ  la liste des fonctionnalitÃ©s de lâ€™application que l'on va crÃ©er :</p>
<ul>
<li>Lister les tÃ¢ches.</li>
<li>Ajouter une tÃ¢che.</li>
<li>Marquer comme terminÃ© une tÃ¢che.</li>
<li>Suppression d'une tÃ¢che.</li>
</ul>
<h2 id="technologies" tabindex="-1"><a class="header-anchor" href="#technologies" aria-hidden="true">#</a> Technologies</h2>
<p>Dans ce TP nous allons utiliser les technologies suivantes :</p>
<ul>
<li>Laravel (Framework PHP)</li>
<li>Bootstrap 4 (Framework HTML / CSS / JS)</li>
<li>NodeJS (Utilisation de Webpack)</li>
</ul>
<h2 id="initialiser-le-projet" tabindex="-1"><a class="header-anchor" href="#initialiser-le-projet" aria-hidden="true">#</a> Initialiser le projet</h2>
<p>La premiÃ¨re Ã©tape lors d'un projet Laravel est la crÃ©ation de la structure avec une simple ligne de commande, dans notre cas :</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ laravel new laravel-todo
Crafting application<span class="token punctuation">..</span>.
Loading <span class="token function">composer</span> repositories with package information
Installing dependencies <span class="token punctuation">(</span>including require-dev<span class="token punctuation">)</span> from lock <span class="token function">file</span>
<span class="token punctuation">[</span>â€¦<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>âœ‹ Attention, le projet va Ãªtre crÃ©Ã© dans le dossier <code>laravel-todo</code> dans le dossier courant.</p>
<p>La crÃ©ation prend environ 1 minute, un certain nombre de librairies sont tÃ©lÃ©chargÃ©es. Une fois terminÃ©, prenez quelques instants pour regarder les fichiers qui ont Ã©tÃ© crÃ©Ã©s.</p>
<h3 id="ğŸ¤“-questions" tabindex="-1"><a class="header-anchor" href="#ğŸ¤“-questions" aria-hidden="true">#</a> ğŸ¤“ Questions</h3>
<ul>
<li>OÃ¹ sont les librairies ?</li>
<li>Quel est l'intÃ©rÃªt Ã  votre avis d'utiliser un outil pour initialiser un projet ?</li>
</ul>
<h2 id="configurer-le-projet-le-env" tabindex="-1"><a class="header-anchor" href="#configurer-le-projet-le-env" aria-hidden="true">#</a> Configurer le projet, le .env</h2>
<p>Le projet qui vient d'Ãªtre crÃ©Ã© est Â« gÃ©nÃ©rique Â» c'est-Ã -dire qu'il ne possÃ¨de aucune personnalisation et peut donc servir de base, quel que soit votre dÃ©veloppement.</p>
<p>La premiÃ¨re Ã©tape va donc Ãªtre d'Ã©diter le fichier <code>.env</code> pour configurer les options de base de votre projet tel que :</p>
<ul>
<li>Le nom</li>
<li>Le type de base de donnÃ©es</li>
<li>â€¦</li>
</ul>
<p>C'est parti !</p>
<h3 id="nom-de-l-application" tabindex="-1"><a class="header-anchor" href="#nom-de-l-application" aria-hidden="true">#</a> Nom de l'application</h3>
<ul>
<li>Todolist</li>
</ul>
<h3 id="base-de-donnees" tabindex="-1"><a class="header-anchor" href="#base-de-donnees" aria-hidden="true">#</a> Base de donnÃ©es</h3>
<p>Pour ne pas avoir Ã  installer un serveur MySQL nous allons utiliser une base de donnÃ©es Â« local Â».</p>
<p>Connaissez-vous le nom d'un type de base de donnÃ©es permettant de travailler en Â« local Â» c'est-Ã -dire sans serveur ?</p>
<Reveal text="Voir la suite du TP">
<p>La rÃ©ponse est SQLite. SQLite est une base de donnÃ©es de type SQL, mais ne nÃ©cessitant pas de serveur, l'ensemble des donnÃ©es est contenu dans un fichier Â« local Â». Pour la crÃ©er rien de plus simple il suffit de crÃ©er un fichier vide dans le dossier de votre projet fait :</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ <span class="token function">touch</span> database/database.sqlite
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Attention: Utiliser git-bash pour avoir la commande <code>touch</code></p>
<p>Maintenant que le fichier a Ã©tÃ© crÃ©Ã© nous allons indiquer Ã  Laravel qu'il faut l'utiliser pour cela, Ã©diter le fichier <code>.env</code> et modifier la ligne :</p>
<div class="language-apacheconf ext-apacheconf line-numbers-mode"><pre v-pre class="language-apacheconf"><code>DB_CONNECTION=mysql
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>par :</p>
<div class="language-apacheconf ext-apacheconf line-numbers-mode"><pre v-pre class="language-apacheconf"><code>DB_CONNECTION=sqlite
DB_DATABASE=database/database.sqlite
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></Reveal>
<h4 id="tester" tabindex="-1"><a class="header-anchor" href="#tester" aria-hidden="true">#</a> Tester</h4>
<p>Vous pouvez maintenant tester votre application / site web. Comme vu en cours, Laravel intÃ¨gre un serveur de dÃ©veloppement ce qui permet de le tester rapidement. Le lancement se fait via la commande suivante :</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ php artisan serve
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h4 id="ğŸ¤“-questions-1" tabindex="-1"><a class="header-anchor" href="#ğŸ¤“-questions-1" aria-hidden="true">#</a> ğŸ¤“ Questions</h4>
<ul>
<li>Ã€ votre avis, comment revenir avec une base de donnÃ©es type Mysql ?</li>
<li>Est-il possible d'utiliser les deux types de bases de donnÃ©es (par exemple en production MySQL et en developpement SQLite) ?</li>
<li>SQLite est-il toujours pertinent ?</li>
</ul>
<h3 id="le-reste-du-fichier-env" tabindex="-1"><a class="header-anchor" href="#le-reste-du-fichier-env" aria-hidden="true">#</a> Le reste du fichier .env</h3>
<p>Nous n'allons pas toucher aux autres paramÃ¨tres, mais certains sont tout de mÃªme intÃ©ressants. Je vous laisse donc consulter la documentation en ligne de Laravel :</p>
<p><a href="https://laravel.com/docs/5.6/configuration" target="_blank" rel="noopener noreferrer">Consulter en ligne<ExternalLinkIcon/></a></p>
<h2 id="conception-de-la-base-de-donnees" tabindex="-1"><a class="header-anchor" href="#conception-de-la-base-de-donnees" aria-hidden="true">#</a> Conception de la base de donnÃ©es</h2>
<p>VoilÃ  Ã  quoi va ressembler notre base de donnÃ©es :</p>
<p><img src="@source/tp/laravel/ressources/todos.png" alt="MCD Simple"></p>
<p>ğŸ¤“ Câ€™est parti ! Tout est prÃªt, nous pouvons commencer Ã  Ã©crire du code.</p>
<h2 id="creation-de-la-Â«-migration-Â»" tabindex="-1"><a class="header-anchor" href="#creation-de-la-Â«-migration-Â»" aria-hidden="true">#</a> CrÃ©ation de la Â« migration Â»</h2>
<p>Laravel utilise un ORM pour manipuler la base de donnÃ©es. Pour rappel un ORM est</p>
<blockquote>
<p>Un mapping objet-relationnel (en anglais object-relational mapping ou ORM) est une technique de programmation informatique qui crÃ©e l'illusion d'une base de donnÃ©es orientÃ©e objet Ã  partir d'une base de donnÃ©es relationnelle en dÃ©finissant des correspondances entre cette base de donnÃ©es et les objets du langage utilisÃ©.</p>
</blockquote>
<p>L'ORM utilisÃ© par Laravel est Eloquent, il est Ã  la fois puissant et relativement simple. Autrement dit avec un ORM dans la plupart des cas vous n'Ã©crivez plus de requÃªte SQL, mais vous manipulez des objets reprÃ©sentant la base de donnÃ©es.</p>
<p>Comme pour la crÃ©ation du projet, la crÃ©ation de la dÃ©finition de la table Â« todos Â» va se faire via une requÃªte dans votre terminal :</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>php artisan make:migration create_todos_table --create<span class="token operator">=</span>todos
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Lâ€™option <code>--create=todos</code> permet dâ€™indiquer le nom du modÃ¨le de la table Ã  crÃ©er.</p>
<p>âœ‹ Le contenu du fichier crÃ©Ã© est fictif, il est lÃ  pour illustrer comment travailler. Nous allons le modifier pour mettre les informations relatives Ã  notre table.</p>
<p>La commande vient de crÃ©er un nouveau fichier dans le dossier <code>database/migration</code>. Dans mon cas le fichier se nomme :</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>YYYY_11_09_150442_create_todos_table.php
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Nous allons dÃ©finir notre schÃ©ma (Ã  savoir la dÃ©finition de la table) pour y ajouter les 2 colonnes qui nous seront utiles <code>texte</code> et <code>termine</code>. L'ORM Ã©tant une librairie objet, la dÃ©finition de nouveaux champs se fait via une mÃ©thode, dans notre cas :</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code>    <span class="token variable">$table</span><span class="token operator">-></span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'texte'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-></span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'termine'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Vous pouvez ajouter les deux champs dans la mÃ©thode <code>up</code> du fichier.</p>
<Reveal text="Voir le fichier avec les nouveaux champs">
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Schema</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Schema<span class="token punctuation">\</span>Blueprint</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Migrations<span class="token punctuation">\</span>Migration</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">CreateTodosTable</span> <span class="token keyword">extends</span> <span class="token class-name">Migration</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * Run the migrations.
     *
     * <span class="token keyword">@return</span> <span class="token class-name"><span class="token keyword">void</span></span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'todos'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name type-declaration">Blueprint</span> <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$table</span><span class="token operator">-></span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-></span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'texte'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-></span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'termine'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-></span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Reverse the migrations.
     *
     * <span class="token keyword">@return</span> <span class="token class-name"><span class="token keyword">void</span></span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">down</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">dropIfExists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'todos'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div></Reveal>
<h3 id="ğŸ¤“-questions-2" tabindex="-1"><a class="header-anchor" href="#ğŸ¤“-questions-2" aria-hidden="true">#</a> ğŸ¤“ Questions</h3>
<ul>
<li>Ã€ quoi correspond la mÃ©thode <code>up</code> et <code>down</code> ?</li>
<li>L'ordre des champs est-il important ?</li>
</ul>
<h2 id="creation-en-base" tabindex="-1"><a class="header-anchor" href="#creation-en-base" aria-hidden="true">#</a> CrÃ©ation en base</h2>
<p>Maintenant que le script est terminÃ©, nous allons indiquer Ã  Laravel d'effectuer Â« la migration Â» c'est-Ã -dire de transformer votre dÃ©finition PHP en instruction SQL pour crÃ©er rÃ©ellement la base de donnÃ©es. Retour dans la ligne de commande :</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ php artisan migrate
<span class="token punctuation">[</span>â€¦<span class="token punctuation">]</span>
Migrating: YYYY_09_09_150442_create_todos_table
Migrated:  YYYY_09_09_150442_create_todos_table
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Votre base de donnÃ©es est maintenant prÃªte Ã  Ãªtre utilisÃ©e. Vous pouvez aller voir le contenu grÃ¢ce Ã  PHPStorm qui est capable (une fois configurÃ©) de requÃªter une base SQLite.</p>
<p><img src="@source/tp/laravel/ressources/sqlite-phpstorm.png" alt="sqlite">
<img src="@source/tp/laravel/ressources/sqlite1.png" alt="sqlite1">
<img src="@source/tp/laravel/ressources/sqlite2.png" alt="sqlite2">
<img src="@source/tp/laravel/ressources/sqlite3.png" alt="sqlite3"></p>
<h3 id="le-modele" tabindex="-1"><a class="header-anchor" href="#le-modele" aria-hidden="true">#</a> Le modÃ¨le</h3>
<p>Maintenant que nous avons fait le script de crÃ©ation / migration, nous allons dÃ©finir notre modÃ¨le.</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ php artisan make:model Todos
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>La commande va crÃ©er le fichier <code>Todos.php</code> dans le dossier <code>app/Models</code>.</p>
<p>Ajouter dans la class :</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code>    <span class="token keyword">protected</span> <span class="token variable">$fillable</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'texte'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'termine'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>âš ï¸ Cette propriÃ©tÃ© est optionnelle, elle permet vous autorisera plus tard Ã  faire du Â« mass-assignment Â» c'est-Ã -dire Ã  crÃ©er un objet Â« Todos Â» depuis par exemple le POST HTTP.</p>
<h2 id="le-controller" tabindex="-1"><a class="header-anchor" href="#le-controller" aria-hidden="true">#</a> Le controller</h2>
<p>Maintenant que nous avons la migration et le modÃ¨le de notre base de donnÃ©es, nous allons crÃ©er le controller. Pour rappel le controller va faire Â« le lien Â» entre la base de donnÃ©es et les appels HTTP. Câ€™est ici que nous allons mettre la logique mÃ©tier de notre application.</p>
<p>Pour commencer, nous allons crÃ©er Â« la structure de base Â» de notre controller.</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ php artisan make:controller TodosController
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Le fichier <code>TodosController.php</code> vient d'Ãªtre crÃ©Ã© dans le chemin suivant <code>app/Http/Controllers/</code>.</p>
<p>Bien ! Notre code est maintenant prÃªt. Nous allons crÃ©er les mÃ©thodes permettant la manipulation de notre base de donnÃ©es tout en rÃ©pondant Ã  nos problÃ©matiques d'interface (liste, crÃ©ation, terminer, suppression).</p>
<p>Nous allons maintenant Ã©crire une mÃ©thode pour chaque action. Avec les diffÃ©rentes conditions nÃ©cessaires au bon fonctionnement de l'application.</p>
<h3 id="corriger-le-chemin-de-la-database" tabindex="-1"><a class="header-anchor" href="#corriger-le-chemin-de-la-database" aria-hidden="true">#</a> Corriger le chemin de la database</h3>
<p>Bizarrerie de Laravelâ€¦ Il faut maintenant changer le chemin de la base de donnÃ©es pour faire correctement rÃ©fÃ©rence au fichier <code>database.sqlite</code> (pour que Ã§a fonctionne depuis votre browser).</p>
<p>Ã‰diter Ã  nouveau le fichier <code>.env</code> pour remplacer :</p>
<div class="language-apacheconf ext-apacheconf line-numbers-mode"><pre v-pre class="language-apacheconf"><code>DB_DATABASE=database/database.sqlite
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>par</p>
<div class="language-apacheconf ext-apacheconf line-numbers-mode"><pre v-pre class="language-apacheconf"><code>DB_DATABASE=../database/database.sqlite
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">PS</p>
<p>Avec une base de donnÃ©es MySQL ce genre de soucis n'existe pas.</p>
</div>
<h3 id="la-methode-Â«-liste-Â»" tabindex="-1"><a class="header-anchor" href="#la-methode-Â«-liste-Â»" aria-hidden="true">#</a> La mÃ©thode Â« Liste Â»</h3>
<p>La mÃ©thode <code>liste</code> est certainement la plus simple, nous allons faire appel Ã  la mÃ©thode <code>all()</code> de Eloquent (ORM pour lâ€™accÃ¨s Ã  la base de donnÃ©es). Pour Ã§a crÃ©ez une nouvelle mÃ©thode dans la Class <code>TodoController</code> avec le code suivant.</p>
<p>Pour l'instant nous n'allons pas intÃ©grer Ã‰loquent, mais uniquement dÃ©finir notre mÃ©thode.</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">liste</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string double-quoted-string">"Liste"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Rien de bien compliquÃ©, comme vous pouvez le voir.</p>
<h3 id="les-autres-methodes" tabindex="-1"><a class="header-anchor" href="#les-autres-methodes" aria-hidden="true">#</a> Les autres mÃ©thodes</h3>
<p>âœ‹ Pour l'instant nous allons nous arrÃªter lÃ  pour la partie code PHP. Cette mÃ©thode est suffisante pour Â« tester Â» le premier template que nous allons Ã©crire.</p>
<h3 id="ajout-route" tabindex="-1"><a class="header-anchor" href="#ajout-route" aria-hidden="true">#</a> Ajout route /</h3>
<p>Nous allons tester la route <code>/</code>, pour Ã§a nous allons remplacer le contenu du fichier <code>routes/web.php</code> par :</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"TodosController@liste"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Vous pouvez relancer votre serveur de test, vous devez maintenant voir Â« Liste Â».</p>
<h2 id="creer-les-templates" tabindex="-1"><a class="header-anchor" href="#creer-les-templates" aria-hidden="true">#</a> CrÃ©er les templates</h2>
<p>Nous avons donc maintenant :</p>
<ul>
<li>La structure Laravel.</li>
<li>La dÃ©finition de notre base de donnÃ©es.</li>
<li>Les dÃ©pendances clients (bootstrap 4â€¦)</li>
</ul>
<p>Nous allons donc pouvoir commencer la crÃ©ation des templates. L'organisation du code est quelque chose d'important, elle n'est pas Ã  nÃ©gliger. Un code organisÃ© est un code agrÃ©able Ã  rÃ©diger.</p>
<p>Notre vue va Ãªtre dÃ©coupÃ©e en 3 parties :</p>
<p><img src="@source/tp/laravel/ressources/parties.png" alt="Structure"></p>
<ul>
<li>âœ‹ Pourquoi le dÃ©coupage en Â« 3 templates Â» est-il important ?</li>
<li>Quelle est l'avantage pour le dÃ©veloppeur ?</li>
</ul>
<h3 id="le-template-principal" tabindex="-1"><a class="header-anchor" href="#le-template-principal" aria-hidden="true">#</a> Le template principal</h3>
<p>Nous allons commencer par dÃ©finir notre Â« Template principal Â» celui-ci va contenir l'ensemble des Ã©lÃ©ments partagÃ©s sur toutes nos pages Ã  savoir :</p>
<ul>
<li>Les JS</li>
<li>Les CSS</li>
<li>La structure commune</li>
</ul>
<div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>csrf-token<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ csrf_token() }}<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>@yield('title')<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ asset(<span class="token punctuation">'</span>css/app.css<span class="token punctuation">'</span>) }}<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ asset(<span class="token punctuation">'</span>js/app.js<span class="token punctuation">'</span>) }}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar navbar-expand-md navbar-dark bg-dark fixed-top<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-brand<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Ma Todo List<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">></span></span>

    @yield('content')
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Maintenant que nous avons le contenu, nous devons crÃ©er un nouveau fichier.</p>
<ul>
<li>CrÃ©er un nouveau fichier <code>resources/views/template.blade.php</code></li>
<li>Copier-Coller le HTML dans le fichier.</li>
</ul>
<p>ğŸ‘ğŸ‘ Bravo, vous venez de crÃ©er votre premier template.</p>
<h4 id="ğŸ¤“-questions-3" tabindex="-1"><a class="header-anchor" href="#ğŸ¤“-questions-3" aria-hidden="true">#</a> ğŸ¤“ Questions</h4>
<ul>
<li>Pourquoi le fichier est-il nommÃ© <code>â€¦.blade.php</code> ?</li>
<li>Ã€ quoi correspond <span v-pre> <code>{{ asset('â€¦') }}</code> </span>?</li>
<li>Ã€ quoi correspond la directive Â« yield Â»? En quoi est-ce trÃ¨s important ?</li>
<li>Est-il possible de dÃ©finir une Â« zone Â» ou d'autres ressources JS / CSS seront insÃ©rÃ©es lors de l'exÃ©cution ? <a href="https://laravel.com/docs/5.6/blade#stacks" target="_blank" rel="noopener noreferrer">Voir la documentation<ExternalLinkIcon/></a></li>
<li>maintenant que vous avez la rÃ©ponse, ajouter une Â« stack Â» pour le script et le style dans l'entÃªte.</li>
</ul>
<Reveal text="Voir la solution">
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code>    @<span class="token function">stack</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'scripts'</span><span class="token punctuation">)</span>
    @<span class="token function">stack</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'styles'</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></Reveal>
<h3 id="tester-1" tabindex="-1"><a class="header-anchor" href="#tester-1" aria-hidden="true">#</a> Tester</h3>
<p>Pour lancer votre application, c'est dans le terminal que Ã§a se passe :</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code>$ php artisan serve
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Une fois lancer <a href="http://127.0.0.1:8000" target="_blank" rel="noopener noreferrer">rendez-vous sur http://127.0.0.1:8000<ExternalLinkIcon/></a>.</p>
<Reveal text="Un soucis non ?">
<p>Rien nâ€™a changÃ© ? C'est normalâ€¦ Continuons!</p>
</Reveal>
<h2 id="installation-des-dependances-client" tabindex="-1"><a class="header-anchor" href="#installation-des-dependances-client" aria-hidden="true">#</a> Installation des dÃ©pendances client</h2>
<p>Maintenant que la partie base de donnÃ©es est prÃªte, nous allons nous occuper de la partie visualisation de notre application / site web. Nous allons utiliser bootstrap pour gÃ©rer la problÃ©matique d'affichage et de responsive.</p>
<h3 id="ajout-des-libraires" tabindex="-1"><a class="header-anchor" href="#ajout-des-libraires" aria-hidden="true">#</a> Ajout des libraires</h3>
<p>La structure de base de Laravel n'intÃ¨gre pas Bootsrap, par contre il est possible de l'installer dans votre projet.</p>
<p>La faÃ§on la plus rapide est d'intÃ©grer directement dans le <code>&lt;head&gt;</code> de votre projet les librairies suivantes :</p>
<p>Ã‰diter le fichier <code>template.blade.php</code> pour ajouter (dans le <code>&lt;head&gt;</code>):</p>
<div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://code.jquery.com/jquery-3.3.1.slim.min.js<span class="token punctuation">"</span></span>
  <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo<span class="token punctuation">"</span></span>
  <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>anonymous<span class="token punctuation">"</span></span>
<span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js<span class="token punctuation">"</span></span>
  <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49<span class="token punctuation">"</span></span>
  <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>anonymous<span class="token punctuation">"</span></span>
<span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
  <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span>
  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css<span class="token punctuation">"</span></span>
  <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO<span class="token punctuation">"</span></span>
  <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>anonymous<span class="token punctuation">"</span></span>
<span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js<span class="token punctuation">"</span></span>
  <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy<span class="token punctuation">"</span></span>
  <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>anonymous<span class="token punctuation">"</span></span>
<span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>Vous venez d'ajouter Jquery, Bootstrap, et l'ensemble des Ã©lÃ©ments nÃ©cÃ©ssaire Ã  son bon fonctionnement. Notre site Ã  Ã©galement besoin d'une CSS spÃ©cifique. Celle-ci doit Ãªtre ajoutÃ© manuellement.</p>
<p>CrÃ©er un fichier <code>main.css</code> dans <code>public/css</code>. Mettre le contenu suivant :</p>
<div class="language-css ext-css line-numbers-mode"><pre v-pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">padding-top</span><span class="token punctuation">:</span> 5rem<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">form.add</span> <span class="token punctuation">{</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.pull-right</span> <span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.action > .btn</span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 1px 7px 1px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.oi</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> small<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Ajouter Ã  nouveau cette CSS dans le <code>&lt;head&gt;</code> de votre site :</p>
<div class="language-HTML ext-HTML line-numbers-mode"><pre v-pre class="language-HTML"><code>&lt;link href=&quot;{{ asset('css/main.css') }}&quot; rel=&quot;stylesheet&quot; /&gt;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Cette solution n'est pas la meilleure, malheureusement un bug sur les PC du lycÃ©e nous empÃªche d'utiliser NodeJS + npm.</p>
<h4 id="modifications-demandees" tabindex="-1"><a class="header-anchor" href="#modifications-demandees" aria-hidden="true">#</a> Modifications demandÃ©es</h4>
<p>âœ‹ Cette modification n'est nÃ©cessaire que dans le cas ou vous n'utilisez <strong>pas</strong> NodeJS + NPM.</p>
<p>Comme vous l'avez vu avec le fichier <code>main.css</code> il est possible d'avoir un CSS / JS en local dans le dossier public.</p>
<ul>
<li>TÃ©lÃ©charger l'ensemble de librairies http / https (css + js) dans le dossier public (attention Ã  bien les ranger) et les utiliser dans votre head.</li>
</ul>
<h3 id="question" tabindex="-1"><a class="header-anchor" href="#question" aria-hidden="true">#</a> Question</h3>
<ul>
<li>Pourquoi est-ce plus sÃ©curisÃ© ?</li>
<li>Pourquoi la solution des CDN n'est finalement pas si Â« non sÃ©curisÃ©e Â» ?</li>
</ul>
<h3 id="liste-des-todos" tabindex="-1"><a class="header-anchor" href="#liste-des-todos" aria-hidden="true">#</a> Liste des todos</h3>
<p>Maintenant que nous avons dÃ©fini notre template de base, nous allons pouvoir dÃ©finir notre page principale, la page Â« liste des todos Â». Celle-ci va ressembler Ã  :</p>
<p><img src="@source/tp/laravel/ressources/liste.png" alt="liste"></p>
<p>Avant de commencer la rÃ©alisation de ce template, regardons ce que l'on peut y voir :</p>
<ul>
<li>Un formulaire Â« form Â»</li>
<li>Une Â« liste Â»</li>
</ul>
<p>Nous allons donc avoir besoin de composant bootstrap. PremiÃ¨re Ã©tape regarder <a href="https://getbootstrap.com/docs/4.0/components/alerts/" target="_blank" rel="noopener noreferrer">la documentation de bootsrap !<ExternalLinkIcon/></a></p>
<h4 id="ğŸ¤“-questions-4" tabindex="-1"><a class="header-anchor" href="#ğŸ¤“-questions-4" aria-hidden="true">#</a> ğŸ¤“ Questions</h4>
<ul>
<li>Quels composants (components) allons nous avoir besoin ?</li>
<li>Est-ce les seuls ?</li>
</ul>
<h4 id="definition-du-template-Â«-liste-Â»-Â«-home-Â»" tabindex="-1"><a class="header-anchor" href="#definition-du-template-Â«-liste-Â»-Â«-home-Â»" aria-hidden="true">#</a> DÃ©finition du template Â« Liste Â» / Â« Home Â»</h4>
<p>Nous allons crÃ©er un 2nd template celui qui va Ãªtre chargÃ© d'afficher la liste des todos. CrÃ©Ã©r un nouveau fichier <code>resources/views/home.blade.php</code> et y mettre le contenu suivant :</p>
<div class="language-HTML ext-HTML line-numbers-mode"><pre v-pre class="language-HTML"><code>@extends(&quot;template&quot;) @section(&quot;title&quot;, &quot;Ma Todo List&quot;) @section(&quot;content&quot;)
&lt;div class=&quot;container&quot;&gt;
  &lt;div class=&quot;card&quot;&gt;
    &lt;div class=&quot;card-body&quot;&gt;
      &lt;!-- Action --&gt;
      &lt;form action=&quot;/action/add&quot; method=&quot;post&quot; class=&quot;add&quot;&gt;
        &lt;div class=&quot;input-group&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot; id=&quot;basic-addon1&quot;
            &gt;&lt;span class=&quot;oi oi-pencil&quot;&gt;&lt;/span
          &gt;&lt;/span&gt;
          &lt;input
            id=&quot;texte&quot;
            name=&quot;texte&quot;
            type=&quot;text&quot;
            class=&quot;form-control&quot;
            placeholder=&quot;Prendre une noteâ€¦&quot;
            aria-label=&quot;My new idea&quot;
            aria-describedby=&quot;basic-addon1&quot;
          /&gt;
        &lt;/div&gt;
      &lt;/form&gt;

      &lt;!-- Liste --&gt;
      &lt;ul class=&quot;list-group&quot;&gt;
        @forelse ($todos as $todo)
        &lt;li class=&quot;list-group-item&quot;&gt;
          &lt;span&gt;{{ $todo-&gt;texte }}&lt;/span&gt;
          &lt;!-- Action Ã  ajouter pour Terminer et supprimer --&gt;
        &lt;/li&gt;
        @empty
        &lt;li class=&quot;list-group-item text-center&quot;&gt;C'est vide !&lt;/li&gt;
        @endforelse
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
@endsection
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="ğŸ¤“-questions-5" tabindex="-1"><a class="header-anchor" href="#ğŸ¤“-questions-5" aria-hidden="true">#</a> ğŸ¤“ Questions</h3>
<ul>
<li><code>@extends</code> ? Ã€ quoi sert cette directive, pourquoi Â« template Â»?</li>
<li>Modifier le titre afficher dans la barre.</li>
<li>Ã€ quoi correspond le <code>@forelse â€¦ @empty â€¦ @endforelse</code>?</li>
</ul>
<h2 id="et-maintenant" tabindex="-1"><a class="header-anchor" href="#et-maintenant" aria-hidden="true">#</a> Et maintenant ?</h2>
<p>Bienâ€¦ rÃ©cupitulons ! Nous avons :</p>
<ul>
<li>Le modÃ¨le.</li>
<li>Le contrÃ´leur.</li>
<li>Les templates (template et home).</li>
</ul>
<p>Il faut maintenant assembler l'ensemble pour que votre page s'affiche lors d'une requÃªte.</p>
<h2 id="tester-2" tabindex="-1"><a class="header-anchor" href="#tester-2" aria-hidden="true">#</a> Tester</h2>
<p>Vous voyez Â« Liste Â» ? C'est OK !</p>
<h2 id="affichage-de-la-liste" tabindex="-1"><a class="header-anchor" href="#affichage-de-la-liste" aria-hidden="true">#</a> Affichage de la liste</h2>
<p>Bon afficher Â« Liste Â» c'est un bon dÃ©butâ€¦ Modifier la mÃ©thode <code>liste()</code> pour qu'elle ressemble Ã  :</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code>    <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"home"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"todos"</span> <span class="token operator">=></span> <span class="token class-name static-context">Todos</span><span class="token operator">::</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="tester-3" tabindex="-1"><a class="header-anchor" href="#tester-3" aria-hidden="true">#</a> Tester</h2>
<p>La page s'affiche ? Super !</p>
<ul>
<li>Ajouter une entrÃ©e Â« Ã  la main Â» grÃ¢ce Ã  l'explorateur de base de donnÃ©es de PHPStorm.</li>
</ul>
<p>Rafraichissez la page, vous devez maintenant voir votre texte ğŸ˜.</p>
<h2 id="action-d-ajout" tabindex="-1"><a class="header-anchor" href="#action-d-ajout" aria-hidden="true">#</a> Action d'ajout</h2>
<p>Maintenant que nous avons implÃ©mentÃ© la liste, nous allons pouvoir faire le code pour la partie Â« ajout d'une tÃ¢che Â». La mÃ©thodologie sera la mÃªme que pour la liste Ã  savoir :</p>
<ul>
<li>Ajout du code dans le contrÃ´leur.</li>
<li>Ajout de la route.</li>
<li>Modification du template pour implÃ©menter la fonctionnalitÃ©.</li>
</ul>
<h3 id="le-controleur" tabindex="-1"><a class="header-anchor" href="#le-controleur" aria-hidden="true">#</a> Le contrÃ´leur</h3>
<p>Nous allons faire un mapping automatique entre la requÃªte HTTP et le modÃ¨le <code>Todos</code></p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">saveTodo</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name static-context">Todos</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-></span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Que va-t-il se passer lors de lâ€™appel ? Lâ€™objet <code>$request</code> contiens tous les paramÃ¨tres de lâ€™appel HTTP, la mÃ©thode <code>all()</code> permets de les rÃ©cupÃ©rer. Lâ€™objet <code>Todos</code> possÃ¨de une mÃ©thode permettant de crÃ©er un nouvel enregistrement en base de donnÃ©es. Les valeurs passÃ©es en paramÃ¨tre de <code>create()</code> permettre de renseigner automatiquement les champs en base de donnÃ©es.</p>
<p>âœ‹ Tester l'ajout. Normalement, Ã§a ne doit pas fonctionnerâ€¦ Pourquoi ? Tout simplement, car nous ne spÃ©cifions pas l'ensemble des champs nÃ©cessaire Ã  la crÃ©ation de notre objet.</p>
<ul>
<li>Quelle est l'autre solution possible ?</li>
</ul>
<Reveal text="Voir la solution">
La premiÃ¨re approche est la plus rapide, mais elle sous-entend que tous les paramÃ¨tres soient bien initialisÃ©s dans Â« lâ€™input Â» HTTP. Dans cette version la mÃ©thode est plus complÃ¨te et gÃ¨re la crÃ©ation de lâ€™objet Todos manuellement, en rÃ©cupÃ©rant les diffÃ©rents Ã©lÃ©ments dans la requÃªte HTTP.
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">saveTodo</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$texte</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-></span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'texte'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$texte</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token variable">$todo</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Todos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token variable">$todo</span><span class="token operator">-></span><span class="token property">texte</span> <span class="token operator">=</span> <span class="token variable">$texte</span><span class="token punctuation">;</span>
      <span class="token variable">$todo</span><span class="token operator">-></span><span class="token property">termine</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token variable">$todo</span><span class="token operator">-></span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></Reveal>
<p>Et c'est tout ! Simple non ?</p>
<h3 id="la-route" tabindex="-1"><a class="header-anchor" href="#la-route" aria-hidden="true">#</a> La Route</h3>
<p>Pour la route modifier le fichier <code>routes/web.php</code> :</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>TodosController</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/action/add'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token class-name static-context">TodosController</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"saveTodo"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="ğŸ¤“-questions-6" tabindex="-1"><a class="header-anchor" href="#ğŸ¤“-questions-6" aria-hidden="true">#</a> ğŸ¤“ Questions</h4>
<ul>
<li>Ã€ quoi correspond le mot-clÃ© Â« post Â» ?</li>
<li>Que se passe-t-il si on fait un appel de type GET (ou PUT, â€¦) ?</li>
</ul>
<h4 id="tester-4" tabindex="-1"><a class="header-anchor" href="#tester-4" aria-hidden="true">#</a> Tester</h4>
<p>Maintenant que nous avons notre action d'ajout, nous allons pouvoir tester notre Todo List rÃ©ellement.</p>
<ul>
<li>DÃ©marrer votre serveur de test (<code>php artisan serve</code>).</li>
<li>Ajouter une nouvelle todo dans l'interface.</li>
<li>Vous devez avoir une erreur 419. Ã€ quoi correspond-elle ?</li>
</ul>
<h4 id="correction-de-l-erreur-419" tabindex="-1"><a class="header-anchor" href="#correction-de-l-erreur-419" aria-hidden="true">#</a> Correction de l'erreur 419</h4>
<p>L'erreur 419 indique que votre Token <code>CSRF</code> (antirejeu) est expirÃ©, ou plutÃ´t dans notre cas que vous ne l'avez pas fourni. C'est une sÃ©curitÃ© intÃ©grÃ©e Ã  Laravel pour l'ensemble des requÃªtes POST qui arrive dans votre code.</p>
<p>Nous devons donc ajouter un input Â« cachÃ© Â» dans notre formulaire pour envoyer en plus du texte une valeur dite de sÃ©curitÃ©.</p>
<p>Modifier le template <code>home.blade.php</code> pour ajouter le code suivant dans la partie <code>&lt;form&gt;</code> :</p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>&lt;form [â€¦]>
@csrf &lt;!-- &lt;&lt; L'annotation ici ! -->
[â€¦]
&lt;/form>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ğŸ¤“ Oui, oui, c'est juste Ã§a.</p>
<h4 id="reteste" tabindex="-1"><a class="header-anchor" href="#reteste" aria-hidden="true">#</a> RetestÃ©</h4>
<p>Normalement c'est ok !</p>
<p><img src="@source/tp/laravel/ressources/vide.png" alt="Vide">
<img src="@source/tp/laravel/ressources/message1.png" alt="avec message 1"></p>
<h2 id="action-marquer-comme-termine" tabindex="-1"><a class="header-anchor" href="#action-marquer-comme-termine" aria-hidden="true">#</a> Action : marquer comme terminÃ©</h2>
<p>Pour lâ€™action terminÃ©e, nous allons devoir updater un enregistrement en base de donnÃ©es, pour Ã§a nous allons le rÃ©cupÃ©rer puis mettre le <code>boolean</code> <code>termine</code> Ã  1.</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">markAsDone</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$todo</span>  <span class="token operator">=</span> <span class="token class-name static-context">Todos</span><span class="token operator">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$todo</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$todo</span><span class="token operator">-></span><span class="token property">termine</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token variable">$todo</span><span class="token operator">-></span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="route" tabindex="-1"><a class="header-anchor" href="#route" aria-hidden="true">#</a> Route</h3>
<p>Ajouter une route de type <code>get</code> avec un paramÃ¨tre nommÃ© <code>{id}</code> dans le fichier <code>routes/web.php</code>.</p>
<p>Le lien doit-Ãªtre : <code>/action/done/{id}</code> et la mÃ©thode dans le contrÃ´leur <code>TodosController@markAsDone</code> en vous inspirant des exemples prÃ©cÃ©dents ajouter la bonne instruction dans le fichier <code>routes/web.php</code>.</p>
<h2 id="action-de-suppression" tabindex="-1"><a class="header-anchor" href="#action-de-suppression" aria-hidden="true">#</a> Action de suppression</h2>
<p>Pour la partie suppression, nous allons devoir dans un premier temps rÃ©cupÃ©rer la todo par son ID.</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">deleteTodo</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$todo</span>  <span class="token operator">=</span> <span class="token class-name static-context">Todos</span><span class="token operator">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$todo</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token variable">$todo</span><span class="token operator">-></span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="route-1" tabindex="-1"><a class="header-anchor" href="#route-1" aria-hidden="true">#</a> Route</h3>
<p>Ajouter une route de type <code>get</code> avec un paramÃ¨tre nommÃ© <code>{id}</code> dans le fichier <code>routes/web.php</code>.</p>
<p>Le lien doit-Ãªtre : <code>/action/delete/{id}</code> et la mÃ©thode dans le contrÃ´leur <code>TodosController@deleteTodo</code> en vous inspirant des exemples prÃ©cÃ©dents ajouter la bonne instruction dans le fichier <code>routes/web.php</code>.</p>
<h4 id="questions" tabindex="-1"><a class="header-anchor" href="#questions" aria-hidden="true">#</a> Questions</h4>
<ul>
<li>Un <code>delete</code> de type <code>get</code> est-ce normal ?</li>
<li>Quelle est l'autre solution ?</li>
<li>Pourquoi dans notre cas c'est Â« la seule solution Â» ?</li>
</ul>
<h2 id="ajouter-les-actions-dans-le-template" tabindex="-1"><a class="header-anchor" href="#ajouter-les-actions-dans-le-template" aria-hidden="true">#</a> Ajouter les actions dans le template</h2>
<p>Maintenant que nous avons dÃ©clarÃ© nos Â« 3 actions Â» dans notre contrÃ´leur (et dans le fichier de route) nous allons les utiliser dans notre template Â« home Â» voici les Ã©tapes :</p>
<ul>
<li>Ã‰diter le fichier <code>resources/views/home.blade.php</code>.</li>
<li>VÃ©rifier l'URL de l'action de votre formulaire. (<code>Â« /add Â»</code>)</li>
<li>Ajouter sur chaque ligne de la boucle Â« foreach Â» deux liens qui vont Â« supprimer Â» et Â« terminer Â».</li>
</ul>
<p>Aide :</p>
<p>Pour accÃ©der Ã  une variable exemple <code>id</code> : <code>$todo-&gt;id</code>.</p>
<p>Exemple <span v-pre><code>&lt;a href=&quot;lien{{ $todo-&gt;id }}&quot;&gt;Terminer&lt;/a&gt;</code> </span></p>
<h2 id="ajout-d-une-2nd-page" tabindex="-1"><a class="header-anchor" href="#ajout-d-une-2nd-page" aria-hidden="true">#</a> Ajout d'une 2nd page</h2>
<p>Ajouter une nouvelle page dans votre site web cette page sera la page Â« Ã€ propos Â», aucune aide autre que :</p>
<ul>
<li>Route.</li>
<li>MÃ©thode dans le contrÃ´leur.</li>
<li>Template qui Â« @extends Â» du gabarit / template de base.</li>
<li>Ajouter un lien pour accÃ©der Ã  cette page dans le header du site.</li>
</ul>
<h2 id="evolution-souhaitee-nommer-les-routes" tabindex="-1"><a class="header-anchor" href="#evolution-souhaitee-nommer-les-routes" aria-hidden="true">#</a> Ã‰volution souhaitÃ©e : Nommer les routes</h2>
<p>Comme vous l'avez constatÃ©, nous utilisons les routes comme une simple URL. Avec Laravel il est possible de faire mieux que Ã§a ! Il est possible de nommer les routes (exemple <code>todo.save</code>) pour les utiliser directement dans notre template. Ã‡a va permettre d'amÃ©liorer votre code (changement de contrÃ´leur plus simple par exemple) et surtout de le rendre plus lisible.</p>
<h3 id="modifier-le-fichier-route" tabindex="-1"><a class="header-anchor" href="#modifier-le-fichier-route" aria-hidden="true">#</a> Modifier le fichier route</h3>
<p>Ã‰diter le fichier <code>routes/web.php</code> pour remplacer le contenu par :</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Route</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>TodosController</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token class-name static-context">TodosController</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"liste"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"todo.list"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/action/add'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token class-name static-context">TodosController</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"saveTodo"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'todo.save'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/action/done/{id}'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token class-name static-context">TodosController</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"markAsDone"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'todo.done'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/action/delete/{id}'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token class-name static-context">TodosController</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"deleteTodo"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'todo.delete'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul>
<li>Avez-vous vu la diffÃ©rence ? Des <code>-&gt;name(&quot;â€¦&quot;)</code> sont en plus, vos routes sont maintenant nommÃ©es.</li>
</ul>
<h3 id="editer-votre-template-Â«-home-Â»" tabindex="-1"><a class="header-anchor" href="#editer-votre-template-Â«-home-Â»" aria-hidden="true">#</a> Ã‰diter votre template Â« home Â»</h3>
<p>Maintenant que nous avons Ã©ditÃ© nos routes, il faut les utiliser dans le template pour Ã§a modifier les diffÃ©rents liens (dans le form et dans les <code>&lt;a&gt;</code> d'action) :</p>
<div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code>[â€¦]
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ route(<span class="token punctuation">'</span>todo.save<span class="token punctuation">'</span>) }}<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  [â€¦]

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ route(<span class="token punctuation">'</span>todo.done<span class="token punctuation">'</span>, [<span class="token punctuation">'</span>id<span class="token punctuation">'</span> => $todo->id]) }}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>[â€¦]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ route(<span class="token punctuation">'</span>todo.delete<span class="token punctuation">'</span>, [<span class="token punctuation">'</span>id<span class="token punctuation">'</span> => $todo->id]) }}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>[â€¦]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul>
<li>Avez-vous vu la diffÃ©rence ?</li>
</ul>
<h3 id="utilisation-dans-le-controleur" tabindex="-1"><a class="header-anchor" href="#utilisation-dans-le-controleur" aria-hidden="true">#</a> Utilisation dans le contrÃ´leur</h3>
<p>Il est Ã©galement possible de les utiliser dans le contrÃ´leur via la directive :</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code>    <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'todo.list'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Modifier votre code pour les utiliser.</p>
<h3 id="ğŸ¤“-question" tabindex="-1"><a class="header-anchor" href="#ğŸ¤“-question" aria-hidden="true">#</a> ğŸ¤“ Question</h3>
<ul>
<li>Quel est l'avantage d'utiliser les routes nommÃ©es ?</li>
</ul>
<h2 id="evolution-souhaitee-ajout-de-controle" tabindex="-1"><a class="header-anchor" href="#evolution-souhaitee-ajout-de-controle" aria-hidden="true">#</a> Ã‰volution souhaitÃ©e : Ajout de contrÃ´le</h2>
<p>Seuls les <code>Todos</code> marquÃ©s comme terminer peuvent Ãªtre supprimÃ©s, il faudra donc contrÃ´ler lâ€™Ã©tat avant de faire le <code>delete()</code> en base de donnÃ©es.</p>
<ul>
<li>Modifier la mÃ©thode <code>deleteTodo</code> contrÃ´leur pour ajouter la rÃ¨gle de gestion (Indice <code>$todo-&gt;termine</code>)</li>
<li>Ajouter la directive <code>@if</code> dans le template afficher uniquement les bonnes actions en fonction de l'Ã©tat du todo. <a href="https://laravel.com/docs/5.7/blade#if-statements" target="_blank" rel="noopener noreferrer">Voir la documentation du if avec blade<ExternalLinkIcon/></a></li>
<li>Pour les boutons d'actions, utilisez des icÃ´nes :
<ul>
<li>Exemple <a href="https://fontawesome.com/how-to-use/on-the-web/setup/getting-started?using=web-fonts-with-css" target="_blank" rel="noopener noreferrer">fontawesome<ExternalLinkIcon/></a></li>
<li>Choisir <a href="https://fontawesome.com/icons?d=gallery" target="_blank" rel="noopener noreferrer">une icÃ´ne<ExternalLinkIcon/></a></li>
<li>Utilisation : <code>&lt;i class=&quot;fas fa-stroopwafel&quot;&gt;&lt;/i&gt;</code></li>
</ul>
</li>
<li>Â« Encapsuler Â» votre icÃ´ne autour d'un <code>a</code> exemple <span v-pre><code>&lt;a href=&quot;/actions/done/{{$todo-&gt;id}}&quot; class=&quot;btn btn-success&quot;&gt;&lt;i class=&quot;fas fa-check&quot;&gt;&lt;/i&gt;&lt;/a&gt;</code></span></li>
</ul>
<h2 id="evolution-souhaitee-message-en-cas-d-erreur" tabindex="-1"><a class="header-anchor" href="#evolution-souhaitee-message-en-cas-d-erreur" aria-hidden="true">#</a> Ã‰volution souhaitÃ©e : Message en cas d'erreur</h2>
<p>Avertir l'utilisateur en cas d'erreur est important! Comme vous l'avez constatÃ©, aucune gestion de message d'erreur n'est prÃ©sente dans le contrÃ´leur. ImplÃ©menter des messages (basique) grÃ¢ce Ã  l'aide suivante :</p>
<h3 id="ajouter-un-message-a-afficher" tabindex="-1"><a class="header-anchor" href="#ajouter-un-message-a-afficher" aria-hidden="true">#</a> Ajouter un message Ã  afficher</h3>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token punctuation">[</span>â€¦<span class="token punctuation">]</span>
<span class="token class-name static-context">Session</span><span class="token operator">::</span><span class="token function">flash</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'message'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"Message d'erreur de traitement Ã  dÃ©finir."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Ou</span>
<span class="token variable">$request</span><span class="token operator">-></span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">flash</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'message'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"Message d'erreur de traitement Ã  dÃ©finir."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>â€¦<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="afficher-le-message-dans-votre-template" tabindex="-1"><a class="header-anchor" href="#afficher-le-message-dans-votre-template" aria-hidden="true">#</a> Afficher le message dans votre template</h3>
<div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code>@if(Session::has('message'))
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>alert alert-danger<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>{{ Session::get('message') }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
@endif
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><a href="https://laravel.com/docs/5.6/session#flash-data" target="_blank" rel="noopener noreferrer">Explication sur la mÃ©thode Flash<ExternalLinkIcon/></a></p>
<h3 id="ajout-des-categories" tabindex="-1"><a class="header-anchor" href="#ajout-des-categories" aria-hidden="true">#</a> Ajout des catÃ©gories</h3>
<p>Actuellement votre liste de Todo n'est pas catÃ©gorisÃ©e. Nous allons donc ajouter :</p>
<ul>
<li>Un nouveau <code>modÃ¨le</code> nommÃ© <code>Categorie</code>. (<code>id</code>, <code>nom</code>)</li>
<li>Ajouter une relation entre <code>Todos</code> et <code>Categories</code>. <a href="https://laravel.com/docs/5.8/eloquent-relationships#one-to-one" target="_blank" rel="noopener noreferrer">De Type One To One<ExternalLinkIcon/></a></li>
</ul>
<p>En modifiant Model <code>Todos</code> pour y ajouter :</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code>  <span class="token comment">// â€¦</span>
  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">categorie</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">hasOne</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'App\Categorie'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// â€¦</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul>
<li>Modifier votre base de donnÃ©es (grÃ¢ce Ã  une nouvelle migration) pour ajoute une clÃ© Ã©trangÃ¨re vers une table catÃ©gorie</li>
</ul>
<p>âš ï¸ Ã‰loquent dÃ©termine automatiquement la clÃ© Ã©trangÃ¨re en fonction du nom. Dans la migration vous DEVEZ nommer la clÃ© Ã©trangÃ¨re <code>categorie_id</code>.</p>
<p>Vous devez donc Ã©crire une migration avec :</p>
<div class="language-php ext-php line-numbers-mode"><pre v-pre class="language-php"><code><span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'todos'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name type-declaration">Blueprint</span> <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$table</span><span class="token operator">-></span><span class="token function">unsignedBigInteger</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'categorie_id'</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">unsigned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$table</span><span class="token operator">-></span><span class="token function">foreign</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'categorie_id'</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">references</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'todos'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul>
<li>CrÃ©er une nouvelle table dans une autre migration pour y ajouter la dÃ©finition de la table Categorie (<code>id</code>, <code>nom</code>, <code>timestamps()</code>)</li>
</ul>
<p><a href="https://laravel.com/docs/5.8/migrations#foreign-key-constraints" target="_blank" rel="noopener noreferrer">Pour plus d'information<ExternalLinkIcon/></a></p>
<h3 id="ajouter-une-page-pour-creer-des-categories" tabindex="-1"><a class="header-anchor" href="#ajouter-une-page-pour-creer-des-categories" aria-hidden="true">#</a> Ajouter une page pour crÃ©er des catÃ©gories</h3>
<p>Ajouter un nouveau contrÃ´leur pour gÃ©rer la partie catÃ©gorie (Liste + Ajout)</p>
<h3 id="selection-de-la-categorie" tabindex="-1"><a class="header-anchor" href="#selection-de-la-categorie" aria-hidden="true">#</a> SÃ©lection de la catÃ©gorie</h3>
<p>Ajouter dans la page principale (<code>/</code>) une liste des catÃ©gories prÃ©sente en base de donnÃ©es. Cette liste doit Ãªtre Ã  cÃ´tÃ© du champ de saisie.</p>
<h3 id="migration-vers-mysql-mariadb" tabindex="-1"><a class="header-anchor" href="#migration-vers-mysql-mariadb" aria-hidden="true">#</a> Migration vers MySQL / MariaDB</h3>
<p>Maintenant que nous avons testÃ© SQlite, nous allons migrer vers un Â« vrai systÃ¨me de base de donnÃ©es Â». Modifier la configuration de votre site internet pour utiliser MySQL.</p>
</template>
