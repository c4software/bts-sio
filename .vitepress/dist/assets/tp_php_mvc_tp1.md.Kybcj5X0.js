import{_ as a}from"./chunks/structure_dossiers.DE3FJtJD.js";import{_ as n,c as l,k as s,I as t,w as p,U as i,D as r,o as h}from"./chunks/framework.aGaNZw_P.js";const o="/assets/organisation_structure.CRyDggQ3.png",d="/assets/organisation.CptPmQTx.png",k="/assets/uml_composition.DjlMQ_J5.png",c="/assets/uml_bdd.Ck_vCWZR.png",j=JSON.parse('{"title":"Structure de d√©veloppement MVC","description":"","frontmatter":{},"headers":[],"relativePath":"tp/php/mvc/tp1.md","filePath":"tp/php/mvc/tp1.md","lastUpdated":1694697956000}'),u={name:"tp/php/mvc/tp1.md"},g=i('<h1 id="structure-de-developpement-mvc" tabindex="-1">Structure de d√©veloppement MVC <a class="header-anchor" href="#structure-de-developpement-mvc" aria-label="Permalink to &quot;Structure de d√©veloppement MVC&quot;">‚Äã</a></h1><p>Cette structure est r√©alis√©e √† des fins p√©dagogiques. Elle est un interm√©diaire permettant d&#39;introduire les concepts du framework Laravel sur des bases de d√©veloppement PHP connu.</p><div class="tip custom-block"><p class="custom-block-title">Attention</p><p>Si vous souhaitez r√©aliser un d√©veloppement d&#39;envergure, je vous d√©conseille vivement l&#39;utilisation de ce code. Pr√©f√©rez plut√¥t l&#39;utilisation d&#39;un framework tel que Laravel</p></div><details class="details custom-block"><summary>Sommaire</summary><nav class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#les-sources">Les sources</a></li><li><a href="#structure">Structure</a><ul><li><a href="#globalement">Globalement</a></li><li><a href="#la-configuration">La configuration</a></li><li><a href="#lancer-votre-site-internet">Lancer votre site Internet</a></li><li><a href="#l-entry-point-index-php">L&#39;entry Point (index.php)</a></li><li><a href="#le-dossier-routes">Le dossier routes/</a></li><li><a href="#le-dossier-controllers">Le dossier controllers/</a></li><li><a href="#le-dossier-views">Le dossier views/</a></li><li><a href="#le-dossier-models">Le dossier models/</a></li><li><a href="#le-dossier-public">Le dossier public/</a></li><li><a href="#le-dossier-utils">Le dossier utils/</a></li><li><a href="#le-dossier-migrations">Le dossier migrations/</a></li></ul></li><li><a href="#ajouter-une-page-dans-un-controleur-existant">Ajouter une page dans un contr√¥leur existant</a></li><li><a href="#ajouter-un-modele">Ajouter un mod√®le</a></li><li><a href="#ajouter-un-nouveau-controleur">Ajouter un nouveau contr√¥leur</a></li><li><a href="#utiliser-un-controleur-recemment-cree">Utiliser un contr√¥leur r√©cemment cr√©√©</a></li></ul></nav></details><ul><li><a href="/cheatsheets/poo/">Aide m√©moire Programmation Orient√©e Objet</a></li><li><a href="/cheatsheets/poo-uml/">La mod√©lisation objet</a></li><li><a href="/cheatsheets/mini-mvc-sample/">Aide m√©moire Mini MVC Sample</a></li></ul><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">‚Äã</a></h2><p>Un des plus c√©l√®bres design patterns s‚Äôappelle MVC (Mod√®le - Vue - Contr√¥leur) ce pattern permet une bonne organisation du son code source. Pour l&#39;instant vous codiez sans vraiment de structure, avec globalement, m√™me si c&#39;√©tait rang√© ; des pages Web qui m√©langent traitement (PHP), acc√®s aux donn√©es (SQL) et pr√©sentation (balises HTML). M√™me si c&#39;est compl√®tement fonctionnel, nous allons nous efforcer √† partir de maintenant √† s√©parer ces parties.</p><p>La structure MVC pr√©sent√©e dans cet exemple est classique. Elle int√®gre les concepts MVC classiques √† savoir :</p><ul><li>Mod√®le (Acc√®s √† la base de donn√©es)</li><li>Vue (Repr√©sentation pour le client)</li><li>Contr√¥leur (Traitement des requ√™tes HTTP entrant)</li></ul><p>Le projet propos√© d√©passe le simple MVC, il int√®gre en effet les bases pour un d√©veloppement serein √† savoir :</p><ul><li>Un routeur : Correspondance entre un chemin (route) et une fonctionnalit√© (m√©thode d&#39;un contr√¥leur).</li><li>Un ensemble d&#39;interfaces et class permettant <ul><li>la r√©alisation d&#39;API.</li><li>l&#39;Acc√®s √† la base de donn√©es.</li><li>La gestion de la SESSION.</li></ul></li><li>Une organisation structur√©e permettant la r√©alisation de projet de taille moyenne / grande.</li></ul><div class="tip custom-block"><p class="custom-block-title">Point important sur la structure.</p><p>Cette base de d√©veloppement int√®gre une structure <strong>qu&#39;il faut respecter</strong> pour d√©velopper dans de bonnes conditions.</p></div><h2 id="les-sources" tabindex="-1">Les sources <a class="header-anchor" href="#les-sources" aria-label="Permalink to &quot;Les sources&quot;">‚Äã</a></h2><p>Vous pouvez t√©l√©charger un code de d√©monstration <a href="https://github.com/c4software/demo-structure-mvc-video/archive/refs/tags/1.2.zip" target="_blank" rel="noreferrer">√† l&#39;adresse suivante en cliquant ici</a></p><p>Voil√† le rendu :</p>',15),m=s("iframe",{width:"560",height:"315",src:"https://www.youtube-nocookie.com/embed/rr4EMZQJhLg",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,-1),E=i('<h2 id="structure" tabindex="-1">Structure <a class="header-anchor" href="#structure" aria-label="Permalink to &quot;Structure&quot;">‚Äã</a></h2><p>Comme indiqu√© en introduction, la structuration d&#39;un d√©veloppement est aussi importante que le d√©veloppement en lui-m√™me. C&#39;est pour √ßa qu&#39;avant m√™me de d√©velopper il est important de prendre en main la structure des dossiers et fichiers propos√©s dans le code pr√©sent√© en exemple.</p><p>La structure de base en termes de dossier ressemble √† :</p><p><img src="'+a+`" alt="Structure des dossiers" loading="lazy"></p><div class="tip custom-block"><p class="custom-block-title">Compliqu√© ?</p><p>Pas d&#39;inqui√©tude, pas de stress ! nous allons voir ensemble comment prendre en main le code.</p></div><h3 id="globalement" tabindex="-1">Globalement <a class="header-anchor" href="#globalement" aria-label="Permalink to &quot;Globalement&quot;">‚Äã</a></h3><p>Le code pr√©sent utilise diff√©rents aspects du d√©veloppement objet :</p><ul><li>Des objets permettant d&#39;encapsuler / organiser la logique autour de repr√©sentation.</li><li>De l&#39;h√©ritage afin d&#39;organiser le code hi√©rarchiquement.</li><li>Des interfaces permettant de d√©finir un comportement.</li></ul><p>Les √©l√©ments de <code>base</code> sont toujours dans un dossier nomm√© <code>base</code>. Vous retrouverez ce dossier pour les contr√¥leurs, les routes, les mod√®les.</p><h3 id="la-configuration" tabindex="-1">La configuration <a class="header-anchor" href="#la-configuration" aria-label="Permalink to &quot;La configuration&quot;">‚Äã</a></h3><p>Avant d&#39;aller plus loin, int√©ressons-nous √† la configuration. Dans un projet, il est √©vident qu&#39;il ne faut pas mettre la configuration n&#39;importe o√π. Vous l&#39;avez v√©cu en entreprise, vous avez peut-√™tre eu √† votre disposition plusieurs serveurs / machines / ordinateurs.</p><p>Votre code va fonctionner de mani√®re identique entre chaque environnement, par contre ce qui va certainement changer c&#39;est l&#39;acc√®s √† la base de donn√©es. Cet acc√®s, est d√©pendant d&#39;une configuration (Utilisateur, Mot de passe, Serveur ‚Ä¶) dans une structure MVC on essai de ne pas mettre cette configuration n&#39;importe o√π !</p><p>Dans l&#39;organisation que je vous propose, cette configuration est centralis√©e dans le fichier <code>configs.php</code> √† la racine du code source.</p><div class="tip custom-block"><p class="custom-block-title">La configuration c&#39;est bien !</p><p>C&#39;est peut-√™tre un d√©tail pour vous‚Ä¶ Mais pour moi √ßa veut dire beaucoup ! Actuellement vous avez un serveur, mais demain peut-√™tre 20‚Ä¶ Et pour votre projet final, vous aurez √† d√©ployer rapidement votre application sur un autre serveur que celui sur lequel vous avez d√©velopp√©.</p><p>Prenez <strong>d√®s maintenant</strong> l&#39;habitude de mettre votre configuration (IP, Serveur, mot de passe de BDD, etc.) dans le fichier <code>configs.php</code>. Dans l&#39;architecture que je vous propose vous y trouverez le minimum n√©cessaire au bon fonctionnement d&#39;une application.</p></div><details class="details custom-block"><summary>Voil√† un exemple</summary><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$DB_SERVER </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;127.0.0.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$DB_DATABASE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;VOTRE_BDD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;DB_USER&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;VOTRE_UTILISATEUR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;DB_PASSWORD&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ET_LE_MOT_DE_PASSE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;DB_DSN&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;mysql:host=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$DB_SERVER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;dbname=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$DB_DATABASE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;DEBUG&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></details><ul><li>Debug ? Vous avez dit debug ? √Ä quoi correspond cette variable √† votre avis ? Comment faire pour. Est-ce important de la mettre √† <code>true</code> ?</li></ul><details class="details custom-block"><summary>Non, mais un instant ? Mon code est diff√©rent.</summary><p>Et oui ! L&#39;exemple que je vous communique plus haut est simpliste. Dans le code que vous avez r√©cup√©r√©, le fichier <code>configs.php</code> est l√©g√®rement diff√©rent. En effet, celui-ci prend un ensemble de variables depuis <code>les variables d&#39;environnements</code> k√©zako !? Les variables d&#39;environnement sont des variables d√©finies au niveau du syst√®me qui nous permettra de changer la configuration sans modifier le code.</p><p>Ce syst√®me de variables d&#39;environnements est tr√®s int√©ressant, car il nous permettra avec l&#39;int√©gration continue de personnaliser le programme au moment de l&#39;ex√©cution sans en changer le code source (Exemple PROD et DEV).</p></details><h3 id="lancer-votre-site-internet" tabindex="-1">Lancer votre site Internet <a class="header-anchor" href="#lancer-votre-site-internet" aria-label="Permalink to &quot;Lancer votre site Internet&quot;">‚Äã</a></h3><p>La structure MVC poss√®de un serveur web int√©gr√©, celui-ci vous permettra de tester votre site web en local sans m√™me avoir besoin de Wamp / Xampp ou autre serveur Apache + PHP.</p><div class="tip custom-block"><p class="custom-block-title">Si votre ordinateur est correctement configur√©</p><p>Vous devriez √™tre capable de faire :</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mvc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> serve</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Cette commande int√©gr√©e √† la structure MVC lancera un serveur automatiquement (sur le port 9000).</p></div><details class="details custom-block"><summary>Comment √ßa fonctionne?</summary><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows (avec XAMPP)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">C:/xampp/php/php</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows (avec WAMP)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">C:/wamp64/bin/php/php8.2.0/php</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Linux / OSX</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9000</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></details><h3 id="l-entry-point-index-php" tabindex="-1">L&#39;entry Point (<code>index.php</code>) <a class="header-anchor" href="#l-entry-point-index-php" aria-label="Permalink to &quot;L&#39;entry Point (\`index.php\`)&quot;">‚Äã</a></h3><p>Le fichier <code>index.php</code> pr√©sent √† la racine du projet est, ce que l&#39;on appelle, un <strong>entry point</strong>. Ce point d&#39;entr√©e en fran√ßais est le fichier qui va ¬´ prendre le trafic ¬ª de votre projet.</p><p>Concr√®tement, qu&#39;est-ce que √ßa veut dire ? √áa veut dire que ce fichier est grandement g√©n√©rique ; en effet, quel que soit le projet celui-ci restera grandement inchang√©. Il int√®gre les initialisations de base permettant √† votre projet de fonctionner correctement. Je vous invite par curiosit√© √† regarder son contenu. Mais pas de modification √† pr√©voir dans ce fichier.</p><p>Une repr√©sentation possible peut-√™tre la suivante :</p><p><img src="`+o+`" alt="Structure &amp; Entry Point" loading="lazy"></p><h3 id="le-dossier-routes" tabindex="-1">Le dossier <code>routes/</code> <a class="header-anchor" href="#le-dossier-routes" aria-label="Permalink to &quot;Le dossier \`routes/\`&quot;">‚Äã</a></h3><p>Le dossier <code>routes/</code> contient l&#39;ensemble du code relatif au Router. Le router est la brique centrale de cette structure MVC, en effet votre utilisateur passera obligatoirement par celui-ci.</p><p>Le routeur est un √©l√©ment simple qui permet de s√©curiser votre code. Celui-ci est en r√©alit√© un simple ¬´ tableau ¬ª contenant l&#39;ensemble des fichiers / ressources accessible depuis le navigateur du client.</p><p>Cet √©l√©ment repose sur le principe de la <code>WhiteList</code> (Liste blanche), nous avons donc de lister l&#39;ensemble ¬´ paths ¬ª (chemins) autoris√© pour deux types de ressources :</p><ul><li>Web (<code>Web.php</code>) : Page Web classique, affich√©e dans un navigateur Web (Chrome, Firefox, etc.)</li><li>Api (<code>Api.php</code>) : √âchange entre un client et le serveur (Ajax, Application, etc.)</li><li>Cli (<code>Cli.php</code>) : D√©finission d&#39;actions accessibles uniquement via la ligne de commande (initialisation de Model, contr√¥leur, initialisation de la base de donn√©es)</li></ul><p>Nous avons un fichier <code>Router.php</code> qui comme l&#39;entry-point est g√©n√©rique, il initialise seulement le code (je vous laisse le regarder par curiosit√©).</p><p>La logique de chargement d&#39;une route est dans <code>routes/base/Route.php</code>, c&#39;est dans ce fichier que ce cache la fameuse, <code>Whitelist</code> mais √©galement la logique de chargement d&#39;une page par rapport √† une demande d&#39;un utilisateur ( chargement en GET ou en POST).</p><h4 id="web-php-et-api-php" tabindex="-1"><code>Web.php</code> et <code>Api.php</code> <a class="header-anchor" href="#web-php-et-api-php" aria-label="Permalink to &quot;\`Web.php\` et \`Api.php\`&quot;">‚Äã</a></h4><p>Les deux fichiers ont une syntaxe identique, c&#39;est normal, il s‚Äôagit de la r√©aliser la d√©claration des routes, celle-ci prendra toujours la m√™me forme :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Web</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $monControleur </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MonControleur</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $monControleur2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MonControleur2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$monControleur, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;laMethodeAAppeler&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/autreChemin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$monControleur, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;lautreMethode&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // {monParametre} est dynamique en fonction du lien utilisateur</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Exemple /exemple/avec/param/1 ou /exemple/avec/param/2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/exemple/avec/param/{monParametre}&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$monControleur, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;methodeAvecParametre&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]); </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/fonction2/home&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$monControleur2, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ma2ndMethode&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]); </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // etc‚Ä¶</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Vous pouvez avoir autant de routes que n√©cessaire</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>Je pense qu&#39;ici pas de probl√®me! Vous comprenez l&#39;id√©e, une nouvelle page ?</p><ul><li>Une nouvelle route</li><li>Une nouvelle m√©thode dans le contr√¥leur‚Ä¶</li><li>Et c&#39;est tout !</li></ul><h4 id="une-route-sans-controleur" tabindex="-1">Une route sans contr√¥leur ? <a class="header-anchor" href="#une-route-sans-controleur" aria-label="Permalink to &quot;Une route sans contr√¥leur ?&quot;">‚Äã</a></h4><p>M√™me s‚Äôil est pr√©f√©rable d&#39;avoir toujours un contr√¥leur, il peut arriver parfois d&#39;avoir besoin d‚Äôune route qui ne d√©pend pas d&#39;un contr√¥leur. Avec la structure MVC, vous pouvez √©crire :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Web</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Vos autres routes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ‚Ä¶</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/about&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;views/global/about.php&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/exemple2/{p1}&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($p1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Valeur par d√©faut&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Function inline 2, Voil√† votre param√®tre : </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$p1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Vos autres routes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ‚Ä¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="danger custom-block"><p class="custom-block-title">üëã</p><p>Utile pour du code tr√®s simple, ou lors d‚Äôun test <strong>uniquement</strong>. L‚Äôutilisation d&#39;un contr√¥leur est pr√©f√©rable.</p></div><h4 id="gerer-l-authentification" tabindex="-1">G√©rer l&#39;authentification ? <a class="header-anchor" href="#gerer-l-authentification" aria-label="Permalink to &quot;G√©rer l&#39;authentification ?&quot;">‚Äã</a></h4><p>Vous allez rapidement avoir besoin d&#39;authentifier un utilisateur. Dans ce cas, √©videmment vous n&#39;allez pas ajouter / lister des routes non accessibles √† tous <strong>(pour des raisons √©videntes de s√©curit√©)</strong>.</p><p>Il conviendra donc de mettre un <code>if</code> autour des routes que vous souhaitez prot√©ger. Par exemple :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> routes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> controllers\\Account</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> controllers\\Main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> controllers\\VideoWeb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> routes\\base\\Route</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> utils\\SessionHelpers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Web</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $videoWeb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> VideoWeb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $main </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $account </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Account</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$videoWeb, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;home&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/tv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$videoWeb, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/about&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$main, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;about&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/login&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$account, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;login&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Les liens /me et /logout ne seront disponibles que pour les utilisateurs ayant un compte.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SessionHelpers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isLogin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/me&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$account, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;me&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/logout&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$account, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;logout&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="le-dossier-controllers" tabindex="-1">Le dossier <code>controllers/</code> <a class="header-anchor" href="#le-dossier-controllers" aria-label="Permalink to &quot;Le dossier \`controllers/\`&quot;">‚Äã</a></h3><p>Le dossier <code>controllers/</code> contiendra l&#39;ensemble des contr√¥leurs de votre projet. Pour l&#39;instant il y en a trois (<code>GlobalWeb.php</code>, <code>VideoApi.php</code>, <code>VideoWeb.php</code>) ils ont chacun un but diff√©rent propre √† mon exemple.</p><p><strong>√áa veut dire</strong> que vous pouvez cr√©er autant de contr√¥leurs que n√©cessaire, il s&#39;agit ici d&#39;un d√©coupage logique des fonctionnalit√©s que vous souhaitez mettre en place.</p><p>Le contr√¥leur est la class PHP qui va faire le lien entre la demande de l&#39;utilisateur (Route) et la donn√©e (mod√®le), son r√¥le sera donc toujours un peu le m√™me :</p><ul><li>R√©cup√©r√© de la donn√©e (BDD, Session, Fichier, etc.).</li><li>La mettre en forme si n√©cessaire.</li><li>La retourner √† l&#39;utilisateur.</li></ul><p>Si nous reprenons la base d&#39;un contr√¥leur, celui-ci aura toujours au minimum la forme suivante :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> controllers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> controllers\\base\\Web</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> utils\\Template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MonControleur</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WebController</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // M√©thode d&#39;exemple</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> methodeDExemple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;views/monControleur/methodeDExemple.php&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Comme vous pouvez le constater ici pas √©norm√©ment de code, en effet une partie de la complexit√© est encapsul√©e dans l&#39;h√©ritage (<code>extends WebController</code>).</p><p>Un contr√¥leur est donc une classe, avec un ensemble de m√©thodes technique permettant de r√©aliser des op√©rations. La ligne :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;views/monControleur/methodeDExemple.php&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Seront votre ¬´ traitement ¬ª / ¬´ votre page ¬ª, nous avons :</p><ul><li><code>Template::render</code> m√©thode qui permet d&#39;afficher votre <strong>vue</strong>. Le premier argument est le fichier √† utiliser, le second est un tableau de param√®tre.</li><li>La tableau de param√®tre (<code>array()</code>), contiendra l&#39;ensemble des variables accessible dans votre vue. Exemple, <code>array(&quot;nom&quot; =&gt; &quot;valentin&quot;)</code> va d√©clarer une variable <code>$nom</code> dans votre <strong>vue</strong>.</li></ul><p>Techniquement, si vous regardez le contenu de la m√©thode, <code>render</code> vous verrez 3 lignes :</p><ul><li><code>header();</code> : Le haut de votre page (avant votre contenu)</li><li><code>include($filepath);</code> : Votre contenu HTML (<strong>et uniquement votre contenu</strong>)</li><li><code>footer();</code> : Le bas de votre page (apr√®s le contenu)</li></ul><p>Nous pouvons le repr√©senter de cette fa√ßon-ci :</p><p><img src="`+d+`" alt="Structure" loading="lazy"></p><div class="tip custom-block"><p class="custom-block-title">L&#39;astuce du chef</p><p>Si vous avez regard√© un peu le code, vous avez certainement remarqu√© que les param√®tres <code>$_GET</code> √©tait automatiquement disponible en tant que param√®tre de votre m√©thode. Exemple :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Si l&#39;utilisateur acc√®de √† /home?nom=brosseau&amp;prenom=valentin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> home</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($nom, $prenom){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // $prenom contiendra ici &quot;brosseau&quot; et $prenom contiendra &quot;valentin&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div><h4 id="l-heritage" tabindex="-1">L&#39;h√©ritage <a class="header-anchor" href="#l-heritage" aria-label="Permalink to &quot;L&#39;h√©ritage&quot;">‚Äã</a></h4><p>Les contr√¥leurs <strong>doivent h√©riter</strong> de l&#39;une des deux interfaces <code>Web</code> ou <code>Api</code>. Ces deux classes d√©finissent un comportement standardis√© entre les diff√©rents contr√¥leurs que vous allez √©crire.</p><p>Les diff√©rentes relations peuvent √™tre repr√©sent√©es avec l&#39;UML suivant :</p><p><img src="`+k+'" alt="UML Relation" loading="lazy"></p><p>La m√©thode <code>redirectTo</code> permet de g√©rer la redirection vers une autre ressource. Rien de bien compliqu√© c&#39;est un simple appel de la m√©thode <code>header</code> de PHP. Je vous laisse regarder le code dans <code>controller/base/WebController.php</code>.</p><div class="tip custom-block"><p class="custom-block-title">Be curious !</p><p>Ne prenez pas automatiquement pour acquis ce que je vous √©cris. Allez voir le code source du projet afin de constater par vous-m√™me ce que je viens de dire / √©crire.</p></div><h3 id="le-dossier-views" tabindex="-1">Le dossier <code>views/</code> <a class="header-anchor" href="#le-dossier-views" aria-label="Permalink to &quot;Le dossier `views/`&quot;">‚Äã</a></h3><p>Le dossier <code>views/</code> va contenir l&#39;ensemble des fichiers ¬´ d&#39;interface ¬ª de votre application. Ces fichiers sont en r√©alit√© massivement des fichiers HTML classiques.</p><p>D√©tail important, nous allons ici privil√©gier le d√©coupage et la r√©utilisation. Il est donc important de constater que nous avons un dossier <code>views/common/</code> celui-ci contient l&#39;ensemble des √©l√©ments commun √† toutes vos pages comme vues pr√©c√©demment. (haut de page et pied de page).</p><p>Vos diff√©rentes pages <strong>ne contiendront donc</strong> que le contenu r√©el de la page exemple :</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Ceci est un titre&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Et voici le contenu&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div>',74),b={class:"tip custom-block"},y=s("p",{class:"custom-block-title"},"Pourquoi est-ce important ?",-1),F=s("p",null,"Au-del√† de tout ce que nous voyons ensemble, mon but est de vous rendre autonome pour que vous puissiez r√©aliser vos propres projets. Et quand il s'agit de projet, le plus important √† retenir c'est l'organisation, mais √©galement √©viter toutes r√©p√©titions.",-1),v=s("p",null,"L'une des principales sources de r√©p√©tition dans un site Web c'est le code pr√©sent dans le header et dans le footer de votre site. C'est pourquoi je vous propose de ne pas le mettre dans chaque page.",-1),C=s("iframe",{src:"https://giphy.com/embed/eBpiVHAzU8XXtvPCae",width:"480",height:"353",frameBorder:"0",class:"giphy-embed",allowFullScreen:""},null,-1),A=i(`<h3 id="le-dossier-models" tabindex="-1">Le dossier <code>models/</code> <a class="header-anchor" href="#le-dossier-models" aria-label="Permalink to &quot;Le dossier \`models/\`&quot;">‚Äã</a></h3><p>Le dossier <code>models/</code> contiens les classes qui vont repr√©senter les tables en base de donn√©es. Ces classes vont faire ¬´ l&#39;interface ¬ª entre votre contr√¥leur et votre base de donn√©es.</p><p>Finis donc les requ√™tes SQL partout dans votre code. √Ä partir de maintenant, vos requ√™tes sont <strong>dans le mod√®le</strong> et uniquement dans le mod√®le.</p><div class="warning custom-block"><p class="custom-block-title">Un instant</p><p>Cette notion de mod√®le <strong>est tr√®s importante</strong>, en effet il s&#39;agit ici d&#39;√™tre explicit et de ne pas faire une classe fourretout!</p><p>Je ne veux donc pas voir de fichier model.php avec 5000 lignes de code. Et encore moins de requ√™tes SQL dans vos contr√¥leurs.</p></div><p>Comme pour les contr√¥leurs, vous avez √† votre disposition (dans le dossier, base) une classe g√©n√©rique vous permettant d&#39;automatiser certaines requ√™tes (<code>getAll</code>, <code>getOne</code>, <code>deleteOne</code>, <code>updateOne</code>). Bien √©videmment ce ne sont que des raccourcis, vous pouvez sans probl√®me √©crire les requ√™tes via PDO.</p><p>Voici un exemple minimal de Mod√®le :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> models</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> models\\base\\SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DBVideo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SQL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        parent::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;LE_NOM_DE_VOTRE_TABLE&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Voici un exemple plus complet :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> models</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> models\\base\\SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DBVideo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SQL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        parent::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;LE_NOM_DE_VOTRE_TABLE&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getVideos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $this</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getByVideoId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($videoId)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Utilisation d&#39;une query √† la place d&#39;un simple getOne car la requ√™te</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // est r√©alis√© sur un champ diff√©rent que l&#39;ID de la table.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $stmt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $this</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getPdo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> video </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> videoId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $stmt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([$videoId]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $stmt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\PDO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FETCH_OBJ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h4 id="l-acces-a-la-base-de-donnees" tabindex="-1">L&#39;acc√®s √† la base de donn√©es <a class="header-anchor" href="#l-acces-a-la-base-de-donnees" aria-label="Permalink to &quot;L&#39;acc√®s √† la base de donn√©es&quot;">‚Äã</a></h4><p>Si vous avez √©t√© curieux‚Ä¶ Vous avez certainement remarqu√© qu&#39;√† aucun moment nous n‚Äôavons parl√© de la connexion √† la base de donn√©es ! C&#39;est aussi √ßa l&#39;avantage d&#39;une organisation structur√©e, je me suis occup√© de cette partie-l√† pour vous.</p><p>La connexion √† la base de donn√©es est int√©gr√©e dans la classe <code>models/base/Database.php</code> qui est utilis√© dans la classe fille <code>models/base/SQL.php</code>.</p><p>Pour l&#39;instant vous serez ¬´ utilisateur ¬ª de cette architecture. Mais, voil√† le diagramme de classe de celle-ci :</p><p><img src="`+c+'" alt="UML BDD" loading="lazy"></p><div class="tip custom-block"><p class="custom-block-title">Pourquoi faire une Interface ?</p><p>Le diagramme de classe vous semble peut-√™tre tr√®s compliqu√© au vu de la probl√©matique‚Ä¶ Mais c&#39;est tout l√† l&#39;int√©r√™t de r√©aliser des Interfaces. En effet, je vous offre (c&#39;est cadeau, c&#39;est pour moi) la classe SQL ; mais peut-√™tre que vous voulez faire du Oracle ? Ou bien du MongoDB ?</p><p>Avec une Interface, aucun probl√®me. Votre code restera inchang√©, quelle que soit l&#39;impl√©mentation de votre connecteur. En effet, impl√©menter l&#39;interface vous obligera l&#39;√©criture des 4 m√©thodes minimale au bon fonctionnement de votre code.</p><p>Ne vous inqui√©tez pas! L&#39;interface est une notion que nous reverrons ensemble plus tard‚Ä¶ Sachez juste qu&#39;elle est une des bases de la programmation orient√©e objet.</p></div><div class="tip custom-block"><p class="custom-block-title">Be curious (bis)</p><p>Ne vous contentez pas de dire ¬´ √ßa marche ¬ª, allez regarder ma classe <code>SQL</code>! Je pense qu&#39;elle est int√©ressante, et que vous devriez la regarder.</p></div><h3 id="le-dossier-public" tabindex="-1">Le dossier <code>public/</code> <a class="header-anchor" href="#le-dossier-public" aria-label="Permalink to &quot;Le dossier `public/`&quot;">‚Äã</a></h3><p>Le dossier <code>public/</code> va contenir l&#39;ensemble des donn√©es ¬´ publics ¬ª de votre projet. Ces fichiers sont ceux distribu√©s directement au navigateur de votre client.</p><p>√áa semble un d√©tail peut-√™tre ? Pourtant c&#39;est un √©l√©ment important ! En effet pourquoi solliciter votre code PHP pour distribuer de la CSS ou des images en plus d&#39;√™tre inutile √ßa surcharge votre serveur inutilement¬†?</p><h3 id="le-dossier-utils" tabindex="-1">Le dossier <code>utils/</code> <a class="header-anchor" href="#le-dossier-utils" aria-label="Permalink to &quot;Le dossier `utils/`&quot;">‚Äã</a></h3><p>Le dossier <code>utils/</code> contient dans la structure de base une classe permettant de g√©rer la SESSION et une classe permettant de g√©n√©rer une image <a href="https://www.gravatar.com/" target="_blank" rel="noreferrer">Gravatar</a>.</p><p>Mais vous allez placer ici l&#39;ensemble des <strong>librairies PHP</strong> n√©cessaire au bon fonctionnement de votre projet.</p><p>Un morceau de code que vous avez trouv√© sur StackOverflow ? Une librairie que vous avez con√ßue ? Pas de probl√®me ! Rangez-les dans le dossier. <code>utils/</code></p><h3 id="le-dossier-migrations" tabindex="-1">Le dossier <code>migrations/</code> <a class="header-anchor" href="#le-dossier-migrations" aria-label="Permalink to &quot;Le dossier `migrations/`&quot;">‚Äã</a></h3><p>Le dossier <code>migrations/</code> contient l&#39;ensemble des fichiers n√©cessaire √† l&#39;installation de votre base de donn√©es. Le fichier <code>RunMigration.php</code> <strong>(√† lancer depuis la console)</strong> charge et ex√©cute l&#39;ensemble des fichiers <code>*.sql</code>. Cette fonctionnalit√© vous permettra :</p><ul><li>De garder une trace de votre sch√©ma.</li><li>Lancer simplement l&#39;installation de votre base de donn√©es.</li><li>Historiser vos ¬´ migrations ¬ª. En effet le script va charger <strong>l&#39;ensemble</strong> des fichiers SQL.</li></ul><p>Pour l&#39;utiliser, vous devez passer via la ligne de commande. En effet, pour des raisons de s√©curit√©, impossible de lancer les migrations depuis votre navigateur.</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mvc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">migrate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="ajouter-une-page-dans-un-controleur-existant" tabindex="-1">Ajouter une page dans un contr√¥leur existant <a class="header-anchor" href="#ajouter-une-page-dans-un-controleur-existant" aria-label="Permalink to &quot;Ajouter une page dans un contr√¥leur existant&quot;">‚Äã</a></h2><p>Ajouter une nouvelle page dans un contr√¥leur se r√©sumera √† 3 op√©rations :</p><ul><li>Ajouter la m√©thode dans le contr√¥leur.</li><li>Ajouter la route permettant l&#39;acc√®s √† la m√©thode.</li><li>Ajouter la vue (template) dans le dossier <code>view</code>.</li></ul><p>Par exemple, si vous souhaitez ajouter une page <code>/ping</code> faisant r√©f√©rence au contr√¥leur <code>Main</code>:</p><ul><li>Ajout dans les routeurs <code>/routes/Web.php</code> :</li></ul><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/ping&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$main, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ping&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>D√©clarer la m√©thode <code>ping()</code> dans le contr√¥leur :</li></ul><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;views/global/ping.php&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;generateAt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;d-m-Y √† H:i&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)));</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>Cr√©er la vue <code>views/global/ping.php</code> :</li></ul><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">h1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PONG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">h1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">center</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&lt;?=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $generateAt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">center</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Je sais que vous aimez les vid√©os‚Ä¶ Voil√† la m√™me proc√©dure r√©sum√©e en vid√©o :</p>',39),D=s("iframe",{width:"560",height:"315",src:"https://www.youtube-nocookie.com/embed/HO7_O10S30o",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,-1),f=i(`<h2 id="ajouter-un-modele" tabindex="-1">Ajouter un mod√®le <a class="header-anchor" href="#ajouter-un-modele" aria-label="Permalink to &quot;Ajouter un mod√®le&quot;">‚Äã</a></h2><p>Pour rappel, le mod√®le est une classe qui va centraliser la partie communication avec la source de donn√©es (SQL ou autre). Dans la structure MVC, <strong>je vous encourage √† cr√©er autant de <code>mod√®les</code> que de tables dans votre base de donn√©es</strong>.</p><p>Une classe mod√®le de type SQL (ce qui vous int√©ressera dans 99.9% des cas) poss√®de toujours la m√™me structure :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> models</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> models\\base\\SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> utils\\Template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VotreTable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SQL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        parent::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;votreTable&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>Le <code>namespace models;</code> permet de structure votre code, et permettra via l&#39;auto-loader l&#39;import automatique de vos classes.</li><li><code>class VotreTable extends SQL</code> indique que votre classe h√©rite de SQL. Elle poss√®dera donc automatiquement des m√©thodes (accessible via <code>$this</code>) : <ul><li><code>getAll</code></li><li><code>getOne</code></li><li><code>deleteOne</code></li><li><code>updateOne</code></li></ul></li><li>Le constructeur <code>__construct()</code> va permettre de cr√©er le parent (Class SQL), le premier param√®tre est le nom de votre table en <strong>base de donn√©es</strong>.</li></ul><div class="danger custom-block"><p class="custom-block-title">On ne range pas le model n&#39;importe o√π !</p><p>Vos mod√®les doivent √™tre obligatoirement dans le dossier <code>models/</code></p></div><div class="warning custom-block"><p class="custom-block-title">Version alternative</p><p>La structure de code int√®gre √©galement quelques commandes accessibles en ligne de commande. Pour cr√©er un nouveau mod√®le rapidement vous pouvez √©galement faire :</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mvc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> model:create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NomDeVotreModel</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></div><div class="tip custom-block"><p class="custom-block-title">Vous n&#39;etes pas limit√©</p><p>Le mod√®le va centraliser l&#39;ensemble de vos requ√™tes, m√™me si de base nous avons quelques m√©thodes de base, vous pouvez √©videmment en ajouter autant que vous souhaitez.</p><p>Exemple :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> models</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> models\\base\\SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Video</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SQL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        parent::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;video&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getPublicVideos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // utilise la connexion BDD pour r√©aliser les requ√™tes vers les donn√©es</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ici retourne l&#39;ensemble des vid√©os de type accessibles √† tous (public)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $stmt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $this</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getPdo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> video </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> public </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $stmt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $stmt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\PDO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FETCH_OBJ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getByVideoId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($videoId)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Utilisation d&#39;une query √† la place d&#39;un simple getOne car la requ√™te</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // est r√©alis√© sur un champs diff√©rent que l&#39;ID de la table.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $stmt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $this</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getPdo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> video </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> videoId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $stmt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([$videoId]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $stmt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\PDO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FETCH_OBJ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div></div><h2 id="ajouter-un-nouveau-controleur" tabindex="-1">Ajouter un nouveau contr√¥leur <a class="header-anchor" href="#ajouter-un-nouveau-controleur" aria-label="Permalink to &quot;Ajouter un nouveau contr√¥leur&quot;">‚Äã</a></h2><p>Le contr√¥leur est le morceau de code (classe) permettant de ¬´ relier ¬ª un lien et une fonctionnalit√©. Comme les mod√®les je vous encourage √† d√©couper votre code au maximum pour regrouper ensemble le code ayant une symbolique commune (exemple, gestion des vid√©os dans contr√¥leur <code>Video</code>, gestion de l&#39;utilisateur dans <code>Account</code>, etc.).</p><p>Comme les mod√®les, les contr√¥leurs ont une structure de base. La diff√©rence est qu&#39;il y a actuellement deux possibilit√©s (Web et API). Dans 99.9% des cas, vous allez r√©aliser des contr√¥leurs de type Web :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> controllers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> controllers\\base\\Web</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> utils\\Template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VotreControleur</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WebController</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> methodeDExemple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        Template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;views/votreVue.php&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, []);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>Le <code>namespace controllers;</code> permet de structure votre code, et permettra via l&#39;auto-loader l&#39;import automatique de vos classes.</li><li><code>class VotreControleur extends WebController</code> indique que votre classe h√©rite de Web (une page client). Elle poss√®dera donc automatiquement la m√©thode (accessible via <code>$this</code>) : <ul><li><code>redirectTo</code></li></ul></li></ul><div class="tip custom-block"><p class="custom-block-title">Et c&#39;est tout !</p><p>Cr√©er un contr√¥leur est aussi simple que √ßa. C&#39;est tellement simple que je vous encourage √† en cr√©er autant que n√©cessaire.</p><p>Dans mon exemple il y a qu&#39;une seule m√©thode <code>methodeDExemple()</code>, √©videmment vous pouvez en cr√©er autant que vous le souhaitez <strong>(il n&#39;y a pas de limite)</strong>.</p></div><div class="warning custom-block"><p class="custom-block-title">Version alternative</p><p>La structure de code int√®gre √©galement quelques commandes accessibles en ligne de commande. Pour cr√©er un nouveau contr√¥leur rapidement vous pouvez √©galement faire :</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mvc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> controller:create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NomDeVotreControleur</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></div><h2 id="utiliser-un-controleur-recemment-cree" tabindex="-1">Utiliser un contr√¥leur r√©cemment cr√©√© <a class="header-anchor" href="#utiliser-un-controleur-recemment-cree" aria-label="Permalink to &quot;Utiliser un contr√¥leur r√©cemment cr√©√©&quot;">‚Äã</a></h2><p>Nous avons cr√©√© un contr√¥leur, mais pour l&#39;utiliser il faut le d√©clarer dans le routeur (par exemple dans le router Web). Mieux que des mots voil√† une vid√©o r√©sumant comment proc√©der :</p>`,17),B=s("iframe",{width:"560",height:"315",src:"https://www.youtube-nocookie.com/embed/6oTe_fO0fVI",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,-1);function q(_,L,x,P,S,w){const e=r("center");return h(),l("div",null,[g,m,E,s("div",b,[y,F,v,t(e,null,{default:p(()=>[C]),_:1})]),A,D,f,B])}const z=n(u,[["render",q]]);export{j as __pageData,z as default};
