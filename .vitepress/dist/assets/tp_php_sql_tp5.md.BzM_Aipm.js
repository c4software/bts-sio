import{a,b as i,c as n,d as t,e as l,_ as r}from"./chunks/le_contenu.PE7MFgD4.js";import{_ as p,c as o,o as d,U as e,k as s}from"./chunks/framework.aGaNZw_P.js";const u="/assets/create_table.CZKZFaJ7.png",h="/assets/phrases_table.mN_2DOKD.png",c="/assets/actions_table.BD6or41B.png",B=JSON.parse('{"title":"Bart PHP et MySQL","description":"","frontmatter":{},"headers":[],"relativePath":"tp/php/sql/tp5.md","filePath":"tp/php/sql/tp5.md","lastUpdated":1612863792000}'),k={name:"tp/php/sql/tp5.md"},m=e('<h1 id="bart-php-et-mysql" tabindex="-1">Bart PHP et MySQL <a class="header-anchor" href="#bart-php-et-mysql" aria-label="Permalink to &quot;Bart PHP et MySQL&quot;">â€‹</a></h1><p>Vous aviez une sessionâ€¦ Et bien maintenant, nous allons mettre en place une base de donnÃ©es ! Celle-ci nous permettra de sauvegarder <strong>de maniÃ¨re</strong> persistante les donnÃ©es de vos utilisateurs.</p><h2 id="premiere-etape-definir-le-besoin" tabindex="-1">PremiÃ¨re Ã©tape dÃ©finir le besoin <a class="header-anchor" href="#premiere-etape-definir-le-besoin" aria-label="Permalink to &quot;PremiÃ¨re Ã©tape dÃ©finir le besoin&quot;">â€‹</a></h2><p>Dans notre application nous souhaitons <strong>enregistrer</strong> les phrases saisies par les utilisateurs. Nous devons donc dÃ©terminer :</p><ul><li>Ce que nous allons sauvegarder (table)</li><li>Les donnÃ©es que nous allons enregistrer (colonnes)</li><li>Sous quel format (type de donnÃ©es)</li><li>Les informations rattachÃ©es Ã  Â« la phrase enregistrÃ© Â». (relation)</li></ul><div class="tip custom-block"><p class="custom-block-title">C&#39;est un mÃ©tier la base de donnÃ©es</p><p>Concevoir une base de donnÃ©es est une chose qui peut-Ãªtre complexe en fonction du projet. Il faut donc y passer du temps idÃ©alement hors du code, voir mÃªme sur une feuille pour avoir les idÃ©es bien claires.</p></div><h2 id="concevoir-le-mcd" tabindex="-1">Concevoir le MCD <a class="header-anchor" href="#concevoir-le-mcd" aria-label="Permalink to &quot;Concevoir le MCD&quot;">â€‹</a></h2><p>La premiÃ¨re Ã©tape d&#39;un dÃ©veloppement avec une base de donnÃ©es est la conception d&#39;un MCD. Le MCD va nous permettre de nous reprÃ©senter visuellement l&#39;ensemble des donnÃ©es ainsi que les relations entre les diffÃ©rentes tables.</p><p>Pour rÃ©aliser le MCD nous avons plusieurs solutions :</p><ul><li>Avec un papier et un crayon.</li><li><a href="https://dbdiagram.io/home" target="_blank" rel="noreferrer">DBDiagram</a></li><li><a href="http://draw.io/" target="_blank" rel="noreferrer">draw.io</a></li></ul><p>Pour moi, dans notre cas nous allons avoir :</p><ul><li>Une table : <strong>phrases</strong>.</li><li>4 colonnes : <strong>id</strong>, <strong>phrase</strong>, <strong>nombre</strong>, <strong>date</strong>, <strong>ip</strong>.</li></ul><p>Je vous laisse concevoir le MCD et dÃ©terminer le format des donnÃ©es.</p><details class="details custom-block"><summary>VoilÃ  le rÃ©sultat dans mon cas</summary><p><img src="'+a+'" alt="MCD" loading="lazy"></p></details><h2 id="transformer-le-mcd-en-base-de-donnees" tabindex="-1">Transformer le MCD en Base de donnÃ©es <a class="header-anchor" href="#transformer-le-mcd-en-base-de-donnees" aria-label="Permalink to &quot;Transformer le MCD en Base de donnÃ©es&quot;">â€‹</a></h2><p>En fonction de votre choix, nous avons deux solutions :</p><ul><li>Si vous avez choisi d&#39;utiliser <a href="https://dbdiagram.io/home" target="_blank" rel="noreferrer">dbdiagram.io</a> celui-ci, intÃ¨gre Â« le script SQL Â» permettant de gÃ©nÃ©rer la base de donnÃ©es (via <em>Export</em>).</li><li>Si vous n&#39;avez pas utilisÃ© dbdiagram, nous allons utiliser l&#39;interface de PhpMyAdmin pour crÃ©er notre base de donnÃ©es.</li></ul><p>L&#39;autre solution, c&#39;est d&#39;Ã©crire Ã  la main le script SQL permettant de crÃ©er la base de donnÃ©es. C&#39;est complÃ¨tement possible, et avec l&#39;habitude c&#39;est Ã©galement trÃ¨s rapide !</p><h3 id="phpmyadmin" tabindex="-1">PhpMyAdmin <a class="header-anchor" href="#phpmyadmin" aria-label="Permalink to &quot;PhpMyAdmin&quot;">â€‹</a></h3><p>PhpMyAdmin est un outil qui va nous permettre d&#39;administrer notre serveur de base de donnÃ©es. Celui-ci est intÃ©grÃ© Ã  votre serveur XAMPP, vu que c&#39;est un site Internet il sera directement accessible par votre navigateur :</p><p><a href="http://localhost/phpmyadmin/" target="_blank" rel="noreferrer">AccÃ©der Ã  PHPMyAdmin</a></p><p><img src="'+i+'" alt="PhpMyAdmin" loading="lazy"></p><p>L&#39;interface de PHPMyAdmin est dÃ©coupÃ©e en 3 morceaux :</p><p><em>La liste des bases de donnÃ©es</em>:</p><p><img src="'+n+'" alt="Les BDD" loading="lazy"></p><p><em>Les actions possibles</em>:</p><p><img src="'+t+'" alt="Les BDD" loading="lazy"></p><p><em>La partie centrale sera diffÃ©rente en fonction de la page / actions (contenu, crÃ©ation, etc)</em>:</p><p><img src="'+l+'" alt="Les BDD" loading="lazy"></p><div class="tip custom-block"><p class="custom-block-title">Un instant</p><p>Avant d&#39;aller plus loin, nous allons faire le tour ensemble de l&#39;interface de phpMyAdmin. Pour dÃ©couvrir quelques fonctionnalitÃ©s.</p><p>ğŸ‘‹ phpMyAdmin est trÃ¨s complet et permet de tout faire. <strong>Mais</strong> ce n&#39;est pas le seul outil qui permet d&#39;administrer une base de donnÃ©es, nous avons Ã©galement :</p><ul><li><a href="https://www.mysql.com/fr/products/workbench/" target="_blank" rel="noreferrer">MySQLWorkbench (gratuit)</a></li><li><a href="https://www.jetbrains.com/datagrip/features/" target="_blank" rel="noreferrer">DataGrip (payant)</a></li><li><a href="https://dbeaver.io/" target="_blank" rel="noreferrer">DBeaver (gratuit)</a></li></ul><p>D&#39;ailleurs, je vous propose de tester DBeaver si Ã§a vous dit.</p></div><h3 id="creer-votre-base-de-donnees-table" tabindex="-1">CrÃ©er votre base de donnÃ©es &amp; Table <a class="header-anchor" href="#creer-votre-base-de-donnees-table" aria-label="Permalink to &quot;CrÃ©er votre base de donnÃ©es &amp; Table&quot;">â€‹</a></h3><p>Maintenant que vous avez fait le tour des fonctionnalitÃ©s de PHPMyAdmin nous allons crÃ©er notre <strong>premiÃ¨re base de donnÃ©es</strong> ğŸ‰. Comme je l&#39;expliquais pendant le cours, notre serveur contient des Bases de donnÃ©es qui peuvent contenir de une Ã  plusieurs centaines de tables.</p><p>Nous allons donc devoir dans un premier temps <strong>crÃ©er une base de donnÃ©es</strong> (bart) puis <strong>crÃ©er une table</strong> (phrases).</p><p>Nous allons le faire ensemble pour la premiÃ¨re fois, mais voilÃ  en vidÃ©o comment vous devez procÃ©der :</p>',34),b=s("iframe",{width:"560",height:"315",src:"https://www.youtube-nocookie.com/embed/i3A6yZQLTYQ",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,-1),g=e('<div class="tip custom-block"><p class="custom-block-title">rappels</p><ul><li>Votre base de donnÃ©es doit se nommer : <code>bart</code>.</li><li>Votre table doit se nommer : <code>phrases</code>.</li></ul></div><div class="danger custom-block"><p class="custom-block-title">ATTENTION</p><p>Un projet === une base de donnÃ©es ! C&#39;est comme les dossiers, ne mÃ©langer pas tout. Et SURTOUT pas les donnÃ©es de diffÃ©rents sites.</p></div><p>âœ‹ Au passage, regarder Ã©galement avec DBeaver votre nouvelle base de donnÃ©es.</p><p>Attaquons maintenant la partie crÃ©ation de la table en elle-mÃªme. Vous allez voir c&#39;est <strong>trÃ¨s trÃ¨s simple</strong>. Il suffit de saisir le nom de votre table dans le formulaire (je vous rappelle le nom de la table <code>phrases</code>).</p><p><img src="'+u+'" alt="Create Table" loading="lazy"></p><p>Une fois validÃ©, celui-ci va vous demander de saisir les diffÃ©rentes colonnes de la table comme dÃ©finie dans votre MCD (d&#39;oÃ¹ l&#39;importance de bien le crÃ©er au dÃ©but).</p>',6),E=s("iframe",{width:"560",height:"315",src:"https://www.youtube-nocookie.com/embed/SIEdalKnjV0",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,-1),v=e('<p>Et voilÃ , votre table est maintenant crÃ©Ã©e nous allons pouvoir ajouter des donnÃ©es.</p><p><img src="'+h+'" alt="Exemple de la Table" loading="lazy"></p><div class="danger custom-block"><p class="custom-block-title">Je vous inviteâ€¦</p><p>Je vous invite Ã  chaque fois Ã  regarder les requÃªtes gÃ©nÃ©rÃ©es par phpMyAdmin se sont les mÃªmes que vous pouvez Ã©crire vous-mÃªme.</p></div><h3 id="ajouter-des-donnees-de-tests" tabindex="-1">Ajouter des donnÃ©es de tests <a class="header-anchor" href="#ajouter-des-donnees-de-tests" aria-label="Permalink to &quot;Ajouter des donnÃ©es de tests&quot;">â€‹</a></h3><p>Nous allons faire les premiÃ¨res insertions de donnÃ©es via PhpMyAdmin, comme je le disais en introduction l&#39;ensemble des actions possibles sont regroupÃ©es dans le menu en haut :</p><p><img src="'+c+'" alt="Actions possibles sur la table" loading="lazy"></p><p>Je vous laisse crÃ©er vous les premiÃ¨res donnÃ©es (menu Â« InsÃ©rer Â»). Une fois crÃ©Ã©e celle-ci seront disponible dans le menu Â« Parcourir Â».</p><div class="danger custom-block"><p class="custom-block-title">Je vous inviteâ€¦</p><p>Je vous invite Ã  chaque fois Ã  regarder les requÃªtes gÃ©nÃ©rÃ©es par phpMyAdmin se sont les mÃªmes que vous pouvez Ã©crire vous-mÃªme, et que nous devrons Ã©crire dans notre code PHP.</p></div><p><strong>C&#39;est Ã  vous</strong> !</p><h3 id="ecrire-les-requetes" tabindex="-1">Ã‰crire les requÃªtes <a class="header-anchor" href="#ecrire-les-requetes" aria-label="Permalink to &quot;Ã‰crire les requÃªtes&quot;">â€‹</a></h3><p>Avant d&#39;attaquer la partie Â« PHP Â», je vous propose d&#39;Ã©crire dans un premier temps les diffÃ©rentes requÃªtesâ€¦</p><ul><li>Le SELECT (obtenir l&#39;ensemble de donnÃ©es).</li><li>l&#39;INSERT (ajouter des donnÃ©es)</li></ul><div class="tip custom-block"><p class="custom-block-title">Rappels</p><p>Le SQL est un langage trÃ¨s puissant, il permet de faire Ã©normÃ©ment de choses. Nous sommes ici dans une introduction nous allons donc faire quelques requÃªtes simples seulement. L&#39;idÃ©e Ã©tant Â« juste Â» de mettre en pratique.</p></div><details class="details custom-block"><summary>En manque d&#39;idÃ©e ?</summary><h3 id="le-select" tabindex="-1">Le SELECT <a class="header-anchor" href="#le-select" aria-label="Permalink to &quot;Le SELECT&quot;">â€‹</a></h3><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phrases;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="l-insert" tabindex="-1">L&#39;INSERT <a class="header-anchor" href="#l-insert" aria-label="Permalink to &quot;L&#39;INSERT&quot;">â€‹</a></h3><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phrases (phrase, nombre, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ip) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Ceci est ma phrase&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1609533688</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;217.23.34.49&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></details><h2 id="acceder-a-la-bdd-depuis-le-php" tabindex="-1">AccÃ©der Ã  la BDD depuis le PHP <a class="header-anchor" href="#acceder-a-la-bdd-depuis-le-php" aria-label="Permalink to &quot;AccÃ©der Ã  la BDD depuis le PHP&quot;">â€‹</a></h2><p>C&#39;est la partie qui nous intÃ©resseâ€¦ Nous allons maintenant Ã©crire le code qui va nous permettre d&#39;accÃ©der Ã  la base de donnÃ©es. En PHP, nous avons Ã  notre disposition plusieurs connecteurs SQL (API).</p><ul><li>mysql_* (dÃ©prÃ©ciÃ©, n&#39;existe plus, mais vous trouverez encore peut-Ãªtre des exemples en ligne <strong>Ã  Ã©viter</strong>)</li><li>MySQLi (le remplacement de mysql_*)</li><li>PDO (PDO_MySQL)</li></ul><p>Nous avons donc deux possibilitÃ©s, la diffÃ©rence entre les deux ? Il y en a plusieurs, mais PDO Ã  un grand avantage c&#39;est qu&#39;il permet de changer simplement de base de donnÃ©es (via des connecteurs pour MariaDB, Oracle, â€¦). Ã€ mon avis <strong>PDO</strong> est doit-Ãªtre votre choix par dÃ©faut dans le cas d&#39;un nouveau projet.</p><p><img src="'+r+`" alt="PDO vs MySQL" loading="lazy"></p><p>Nous allons travailler intelligemment, nous allons utiliser les includes et les variables pour Ã©viter de mettre le code de la connexion Ã  la base de donnÃ©es dans chaque page de notre site.</p><p>Nous allons Ã©galement Â« sortir Â» / Â« mettre Â» en variables les informations de connexion Ã  notre base de donnÃ©es Ã  savoir :</p><ul><li>l&#39;IP du serveur de base de donnÃ©es.</li><li>Le login.</li><li>Le mot de passe.</li><li>Le nom de la base de donnÃ©es</li></ul><p>ğŸ”¥ L&#39;organisation est trÃ¨s importante ! Cette Ã©tape de Â« dÃ©coupage Â» peut paraitre superflue, mais c&#39;est lÃ  oÃ¹ se jouera votre rÃ©ussite.</p><h3 id="utils-db-php" tabindex="-1">utils/db.php <a class="header-anchor" href="#utils-db-php" aria-label="Permalink to &quot;utils/db.php&quot;">â€‹</a></h3><p>Nous allons Ã©crire dans ce fichier le code nous permettant de nous connecter Ã  la base de donnÃ©es. Cette partie du code est fournie directement dans la documentation PHPâ€¦ Comme je suis sympa, je vous fournis directement le code :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Cette partie est Ã  customiser</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$server </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;localhost&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$db </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;bart&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;root&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$passwd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Fin de la partie customisable</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Cette partie est gÃ©nÃ©rique Ã  l&#39;ensemble de vos projets utilisant une base de donnÃ©es.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$dsn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;mysql:host=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;dbname=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$db</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$pdo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PDO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($dsn, $user, $passwd);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ğŸ”¥ Et c&#39;est tout ! VoilÃ , si vous utilisez un <code>include</code> du fichier <code>utils/db.php</code> votre code sera connectÃ© Ã  la base de donnÃ©es et vous pourrez rÃ©aliser des requÃªtes SQL.</p><div class="tip custom-block"><p class="custom-block-title">Nous avons Ã©crit une <code>lib</code></p><p>Ce que vous venez d&#39;Ã©crire est une Â« librairie Â», vous allez pouvoir rÃ©utiliser ce code autant de fois que vous le souhaitez. Il est gÃ©nÃ©rique, vous n&#39;avez plus qu&#39;Ã  le Â« copier / coller Â» dans vos diffÃ©rents projets nÃ©cessitant une base de donnÃ©es.</p></div><p>C&#39;est Ã  vous, je vous laisse Ã©crire le code dans votre projet.</p><h3 id="home-php" tabindex="-1">home.php <a class="header-anchor" href="#home-php" aria-label="Permalink to &quot;home.php&quot;">â€‹</a></h3><p>Dans votre page d&#39;accueil, vous avez actuellement un formulaire, nous allons ajouter Â« en plus Â», une liste des phrases prÃ©cÃ©demment Ã©crite par les utilisateurs. Nous allons donc utiliser la requÃªte de type <code>SELECT</code> qui nous retourne l&#39;ensemble des informations prÃ©sentes dans la base de donnÃ©es.</p><p>Avec PDO, faire ce genre d&#39;opÃ©ration va se rÃ©sumer Ã  3 lignes de code :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// DANS l&#39;index.php</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ATTENTION ATTENTION : Cette ligne ne doit Ãªtre mise qu&#39;une seule fois.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./utils/db.php&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Dans home.php</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// RequÃªtes SQL que nous souhaitons jouer.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $pdo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> phrases&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetchAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\PDO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FETCH_ASSOC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="tip custom-block"><p class="custom-block-title"><code>$results</code></p><p>La variable <code>$results</code> va contenir une structure semblable Ã  :</p><div class="language-text vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>Array</span></span>
<span class="line"><span>(</span></span>
<span class="line"><span>    [0] =&gt; Array</span></span>
<span class="line"><span>        (</span></span>
<span class="line"><span>            [phrase] =&gt; &quot;Ceci est ma phrase&quot;</span></span>
<span class="line"><span>            [nombre] =&gt; 1000</span></span>
<span class="line"><span>            [date] =&gt; 1609536464</span></span>
<span class="line"><span>            [ip] =&gt; &quot;127.0.0.1&quot;</span></span>
<span class="line"><span>        )</span></span>
<span class="line"><span>)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div><p>Je vous laisse mettre en place le code dans votre projet plus prÃ©cisÃ©ment dans le fichier <code>home.php</code>. Nous allons procÃ©der avec logique :</p><ul><li>Inclure le code de connexion Ã  la base de donnÃ©es <code>utils/db.php</code> dans votre <code>index.php</code>.</li><li>Mettre le code permettant de faire une requÃªte tel quel dans la page.</li><li>Afficher le contenu de la variable <code>$results</code> avec un <code>print_r($results);</code> (<strong>POUR TESTER SEULEMENT</strong>).</li><li>Parcourir les rÃ©sultats et les afficher dans un <code>&lt;select&gt;&lt;/select&gt;</code> dans la page en utilisant une boucle de type <code>foreach</code>.</li></ul><p>C&#39;est Ã  vous.</p><h3 id="bart-php" tabindex="-1">bart.php <a class="header-anchor" href="#bart-php" aria-label="Permalink to &quot;bart.php&quot;">â€‹</a></h3><p>Dans la page <code>bart.php</code> celle qui affiche le tableau, nous allons mettre en place le code nous permettant d&#39;ajouter des donnÃ©es dans la base de donnÃ©es. Je vous donne le code vous permettant d&#39;ajouter une entrÃ©e en base de donnÃ©es.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Nous allons utiliser une requÃªte de type Â« prÃ©parÃ© Â». Cette requÃªte est particulier, elle est Â« sÃ©curisÃ©e Â», c&#39;est-Ã -dire que normalement il n&#39;est pas possible de Â« forcer Â» l&#39;ordinateur Ã  exÃ©cuter autre chose que ce que vous aviez prÃ©vu.</p></div><p>Attention, je ne vous donne que Ã§a. Je vous laisse Ã©crire le code au bon endroit :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ATTENTION ATTENTION : Cette ligne ne doit Ãªtre mise qu&#39;une seule fois.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Dans notre cas elle est dÃ©jÃ  dans l&#39;index.php</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./utils/db.php&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$sql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> phrases (phrase, nombre, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, ip) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">values</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(?, ?, ?, ?);&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$stmt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $pdo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($sql);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$stmt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([$phrase, $nombre, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Y-m-d H:i:s&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), $_SERVER[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;REMOTE_ADDR&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ğŸ”¥ Je vous laisse Ã©crire le code au bon endroit. C&#39;est Ã  vous.</p><h2 id="evolution" tabindex="-1">Ã‰volution <a class="header-anchor" href="#evolution" aria-label="Permalink to &quot;Ã‰volution&quot;">â€‹</a></h2><p>Ajouter une nouvelle page dans votre site. Celle-ci doit :</p><ul><li>Respecter le design actuel.</li><li>Afficher les valeurs actuellement en base Ã  l&#39;aide d&#39;un tableau.</li><li>Votre tableau doit Ãªtre paginÃ© (LIMIT, OFFSET) via la requÃªte SQL.</li></ul><p>C&#39;est Ã  vous.</p>`,47),y=[m,b,g,E,v];function q(f,F,C,A,D,_){return d(),o("div",null,y)}const S=p(k,[["render",q]]);export{B as __pageData,S as default};
