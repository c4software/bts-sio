import{_ as t}from"./chunks/apache.x4CsR5gF.js";import{_ as l,a as r,b as p}from"./chunks/filezilla_clefs.DttB0Jlk.js";import{_ as o,c as u,k as e,a as s,I as n,U as i,o as d,D as c}from"./chunks/framework.aGaNZw_P.js";const h="/assets/realisation.BbplEf7G.png",m="/assets/php-version.CxhnIjNl.jpg",v="/assets/vhost.tVJmw-jx.png",k="/assets/vhost-test.DWE52sQi.jpg",b="/assets/vhost-error.CboPmG96.jpg",U=JSON.parse('{"title":"TP2. Configurer un serveur Web","description":"Dans ce TP nous allons voir comment cr√©er un serveur Web (Apache + PHP) et comment le configurer.","frontmatter":{"description":"Dans ce TP nous allons voir comment cr√©er un serveur Web (Apache + PHP) et comment le configurer."},"headers":[],"relativePath":"tp/devops/serveur/tp2.md","filePath":"tp/devops/serveur/tp2.md","lastUpdated":1704218918000}'),g={name:"tp/devops/serveur/tp2.md"},f=e("h1",{id:"tp2-configurer-un-serveur-web",tabindex:"-1"},[s("TP2. Configurer un serveur Web "),e("a",{class:"header-anchor",href:"#tp2-configurer-un-serveur-web","aria-label":'Permalink to "TP2. Configurer un serveur Web"'},"‚Äã")],-1),F={class:"details custom-block"},y=e("summary",null,"Sommaire",-1),C={class:"table-of-contents"},P=e("li",null,[e("a",{href:"#pre-requis"},"Pr√©-requis")],-1),E=e("li",null,[e("a",{href:"#objectifs"},"Objectifs"),e("ul",null,[e("li",null,[e("a",{href:"#ce-que-nous-allons-voir"},"Ce que nous allons voir")])])],-1),q=e("li",null,[e("a",{href:"#ressources"},"Ressources")],-1),A=e("a",{href:"#la-vm"},"La VM",-1),B=e("li",null,[e("a",{href:"#etape-1-creez-une-vm"},"√âtape 1 : Cr√©ez une VM")],-1),w={href:"#creation-de-la-vm-via-un-modele"},x=e("li",null,[e("a",{href:"#etape-2-configurez-la-vm"},"√âtape 2 : Configurez la VM")],-1),_=e("li",null,[e("a",{href:"#etape-3-acces-ssh-a-la-vm"},"√âtape 3 : Acc√®s SSH √† la VM")],-1),H=i('<li><a href="#installation-des-vmtools">Installation des VMTools</a></li><li><a href="#installation-d-apache">Installation d&#39;Apache</a><ul><li><a href="#etape-1-installation-d-apache">√âtape 1 : Installation d&#39;Apache</a></li><li><a href="#etape-2-verification-de-l-installation">√âtape 2 : V√©rification de l&#39;installation</a></li></ul></li><li><a href="#installation-de-php">Installation de PHP</a><ul><li><a href="#etape-1-ajout-du-depot">√âtape 1 : Ajout du d√©p√¥t</a></li><li><a href="#etape-2-installation-de-php">√âtape 2 : Installation de PHP</a></li><li><a href="#etape-3-activer-php-dans-apache">√âtape 3 : Activer PHP dans Apache</a></li></ul></li><li><a href="#conclusion-intermediaire">Conclusion interm√©diaire</a></li><li><a href="#la-configuration-de-php">La configuration de PHP</a></li><li><a href="#la-configuration-d-apache">La configuration d&#39;Apache</a><ul><li><a href="#creer-les-dossiers">Cr√©er les dossiers</a></li><li><a href="#creer-les-fichiers-de-configuration">Cr√©er les fichiers de configuration</a></li><li><a href="#activer-les-sites-web">Activer les sites Web</a></li><li><a href="#desactiver-les-sites-web">D√©sactiver les sites Web</a></li><li><a href="#ecouter-sur-plusieurs-ports">√âcouter sur plusieurs ports</a></li><li><a href="#redemarrer-apache">Red√©marrer Apache</a></li><li><a href="#tester-les-sites-web">Tester les sites Web</a></li><li><a href="#masquer-les-fichiers-presents-dans-le-dossier">Masquer les fichiers pr√©sents dans le dossier</a></li></ul></li><li><a href="#creer-un-site-web">Cr√©er un site Web</a></li><li><a href="#comment-travailler-avec-le-serveur">Comment travailler avec le serveur ?</a><ul><li><a href="#travailler-sur-votre-machine">Travailler sur votre machine</a></li><li><a href="#les-clients-sftp">Les clients SFTP</a></li><li><a href="#via-git">Via Git</a></li><li><a href="#site-web-sur-le-port-80">Site Web sur le port 80</a></li><li><a href="#site-web-sur-le-port-8080">Site Web sur le port 8080</a></li><li><a href="#site-web-sur-le-port-8181">Site Web sur le port 8181</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#liens-utiles">Liens utiles</a></li>',10),V=i('<h2 id="pre-requis" tabindex="-1">Pr√©-requis <a class="header-anchor" href="#pre-requis" aria-label="Permalink to &quot;Pr√©-requis&quot;">‚Äã</a></h2><p>Avant de commencer ce TP, vous devez savoir comment installer un serveur Debian. Si ce n&#39;est pas le cas, vous pouvez suivre le <a href="./tp1b.html">TP1</a>. Je pars du principe que vous ma√Ætrisez √©galement les commandes de base de Linux (voir <a href="/cheatsheets/serveur/linux-debian-based.html">cheatsheet</a>).</p><h2 id="objectifs" tabindex="-1">Objectifs <a class="header-anchor" href="#objectifs" aria-label="Permalink to &quot;Objectifs&quot;">‚Äã</a></h2><p>Dans ce TP nous allons voir comment cr√©er un serveur Web (Apache + PHP) et comment le configurer. Ce type de serveur est tr√®s utilis√© pour h√©berger des sites Web dynamiques. Lors de vos deux ann√©es de BTS, on vous demandera de cr√©er ce genre de serveur, pour mettre √† disposition vos r√©alisations (En AP, mais √©galement lors des projets de fin d&#39;ann√©e).</p><p>Ma√Ætriser la cr√©ation de serveurs est un point important. En effet, derri√®re chaque site Web, il y a un serveur qui tourne. Il est donc important de savoir comment le configurer, et comment le s√©curiser. M√™me s‚Äôil est possible d&#39;h√©berger son site Web sur des plateformes o√π la notion de serveur n&#39;est pas pr√©sente, il est important de savoir comment cela fonctionne afin de pouvoir d√©panner un site Web en cas de probl√®me (gestion des droits, des logs, etc.).</p><div class="danger custom-block"><p class="custom-block-title">Machine type examen</p><p>Comprendre le d√©coupage multimachines est un √©l√©ment important pour le passage de l&#39;examen. Il est donc important de bien comprendre ce que nous faisons dans ce TP.</p></div><h3 id="ce-que-nous-allons-voir" tabindex="-1">Ce que nous allons voir <a class="header-anchor" href="#ce-que-nous-allons-voir" aria-label="Permalink to &quot;Ce que nous allons voir&quot;">‚Äã</a></h3><p>Voil√† l&#39;architecture que nous allons mettre en place :</p><p><img src="'+h+'" alt="R√©alisation" loading="lazy"></p><ul><li>Un serveur Debian 11.</li><li>Un serveur Web Apache.</li><li>PHP 8.X (le <code>X</code> √©tant la derni√®re version disponible).</li></ul><h2 id="ressources" tabindex="-1">Ressources <a class="header-anchor" href="#ressources" aria-label="Permalink to &quot;Ressources&quot;">‚Äã</a></h2><p>Pour r√©aliser ce TP, vous aurez besoin de :</p><ul><li><a href="/cheatsheets/serveur/linux-debian-based.html">Aide m√©moire Debian</a></li><li><a href="/cheatsheets/serveur/debian-reseau.html">G√©n√©rateur de configuration</a></li><li><a href="/cheatsheets/ssh-key/">Aide m√©moire cl√© SSH</a></li></ul><h2 id="la-vm" tabindex="-1">La VM <a class="header-anchor" href="#la-vm" aria-label="Permalink to &quot;La VM&quot;">‚Äã</a></h2><p>Pour ce TP je vais vous demander de cr√©er une VM. Cette VM doit respecter les sp√©cifications suivantes :</p><ul><li>Nom de la VM : <code>&lt;votre nom&gt;-web</code>. (et dans le bon dossier)</li><li>OS : Debian 11.5.</li><li>M√©moire : 2Go (ou la configuration du mod√®le).</li><li>CPU : 1.</li><li>Disque : 20Go (ou la configuration du mod√®le).</li></ul><h3 id="etape-1-creez-une-vm" tabindex="-1">√âtape 1 : Cr√©ez une VM <a class="header-anchor" href="#etape-1-creez-une-vm" aria-label="Permalink to &quot;√âtape 1 : Cr√©ez une VM&quot;">‚Äã</a></h3><p>√Ä l&#39;aide des TP pr√©c√©dents (et de vos notes), cr√©ez une VM qui respecte les sp√©cifications ci-dessus.</p>',18),z={id:"creation-de-la-vm-via-un-modele",tabindex:"-1"},D=e("a",{class:"header-anchor",href:"#creation-de-la-vm-via-un-modele","aria-label":'Permalink to "Cr√©ation de la VM via un mod√®le <Badge type="tip" text="Meilleure solution" vertical="top" />"'},"‚Äã",-1),S=i(`<p>Dans cette version, vous allez cr√©er votre VM √† partir d&#39;un mod√®le. Le mod√®le contient d√©j√† le syst√®me d&#39;exploitation et les logiciels install√©s. Vous n&#39;avez plus qu&#39;√† configurer la VM (r√©seau, utilisateur, etc.).</p><ul><li><a href="./tp1alt.html">Consulter la documentation</a></li></ul><details class="details custom-block"><summary>Alternative</summary><p>Dans cette version, vous allez devoir cr√©er la VM depuis le d√©but. Vous avez plus d&#39;options, mais vous devez r√©aliser l&#39;installation du syst√®me d&#39;exploitation.</p><ul><li><a href="./tp1.html">Consulter la documentation</a></li></ul></details><h3 id="etape-2-configurez-la-vm" tabindex="-1">√âtape 2 : Configurez la VM <a class="header-anchor" href="#etape-2-configurez-la-vm" aria-label="Permalink to &quot;√âtape 2 : Configurez la VM&quot;">‚Äã</a></h3><p>Configurez la VM pour qu&#39;elle respecte les sp√©cifications suivantes :</p><ul><li>La VM doit avoir une IP statique. (Vous pouvez utiliser le g√©n√©rateur de configuration).</li><li>La VM doit avoir acc√®s √† Internet (<code>ping www.google.com</code> dois fonctionner).</li><li>La VM doit poss√©der les <strong>vmtools</strong>. (<code>apt install open-vm-tools</code>).</li></ul><h3 id="etape-3-acces-ssh-a-la-vm" tabindex="-1">√âtape 3 : Acc√®s SSH √† la VM <a class="header-anchor" href="#etape-3-acces-ssh-a-la-vm" aria-label="Permalink to &quot;√âtape 3 : Acc√®s SSH √† la VM&quot;">‚Äã</a></h3><p>Pour vous connecter √† la VM, vous devez utiliser la commande <code>ssh</code> depuis votre machine h√¥te. Pour que cela fonctionne :</p><ul><li>Vous devez avoir install√© le serveur SSH sur votre VM (voir <a href="./tp1b.html">TP pr√©c√©dent</a>).</li><li>Vous devez avoir g√©n√©r√© une cl√© SSH sur votre machine h√¥te et l&#39;avoir ajout√©e √† votre VM (voir <a href="./tp1b.html">TP pr√©c√©dent</a>).</li><li>L&#39;acc√®s par mot de passe doit √™tre d√©sactiv√© sur votre VM (voir <a href="./tp1b.html">TP pr√©c√©dent</a>).</li><li>L&#39;acc√®s <code>root</code> par SSH doit √™tre d√©sactiv√© sur votre VM (voir <a href="./tp1b.html">TP pr√©c√©dent</a>).</li></ul><details class="details custom-block"><summary>Rappel sur la cl√© SSH</summary><p>Pour installer votre cl√© SSH sur votre serveur, il vous suffit de faire la commande suivante sur votre ordinateur.</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh-copy-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">usernam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ipaddres</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>‚ö†Ô∏è Vous devez √©videmment remplacer <code>&lt;username&gt;</code>et <code>&lt;ipaddress&gt;</code>par votre utilisateur et votre mot de passe. Exemple¬†:</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh-copy-id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pi@192.168.1.253</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Rien de plus, √† partir de maintenant votre serveur acceptera votre connexion sans vous demander de mot de passe. Pratique, non¬†? (Et surtout tr√®s s√©curis√©)</p></details><h2 id="installation-des-vmtools" tabindex="-1">Installation des VMTools <a class="header-anchor" href="#installation-des-vmtools" aria-label="Permalink to &quot;Installation des VMTools&quot;">‚Äã</a></h2><p>Avant de commencer, nous allons installer les VMTools. Pour cela, nous allons utiliser la commande <code>apt</code> pour installer le paquet <code>open-vm-tools</code>.</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open-vm-tools</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="installation-d-apache" tabindex="-1">Installation d&#39;Apache <a class="header-anchor" href="#installation-d-apache" aria-label="Permalink to &quot;Installation d&#39;Apache&quot;">‚Äã</a></h2><p>Vous l&#39;avez compris, nous allons installer un serveur Web Apache sur notre VM. Pour cela, nous allons utiliser la commande <code>apt</code> pour installer le paquet <code>apache2</code>.</p><h3 id="etape-1-installation-d-apache" tabindex="-1">√âtape 1 : Installation d&#39;Apache <a class="header-anchor" href="#etape-1-installation-d-apache" aria-label="Permalink to &quot;√âtape 1 : Installation d&#39;Apache&quot;">‚Äã</a></h3><p>Pour installer Apache, vous devez utiliser la commande <code>apt</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="etape-2-verification-de-l-installation" tabindex="-1">√âtape 2 : V√©rification de l&#39;installation <a class="header-anchor" href="#etape-2-verification-de-l-installation" aria-label="Permalink to &quot;√âtape 2 : V√©rification de l&#39;installation&quot;">‚Äã</a></h3><h4 id="verifier-en-ligne-de-commande-que-le-serveur-est-demarre" tabindex="-1">V√©rifier en ligne de commande que le serveur est d√©marr√© <a class="header-anchor" href="#verifier-en-ligne-de-commande-que-le-serveur-est-demarre" aria-label="Permalink to &quot;V√©rifier en ligne de commande que le serveur est d√©marr√©&quot;">‚Äã</a></h4><p>Pour v√©rifier que le serveur est d√©marr√©, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="verifier-que-le-serveur-est-accessible" tabindex="-1">V√©rifier que le serveur est accessible <a class="header-anchor" href="#verifier-que-le-serveur-est-accessible" aria-label="Permalink to &quot;V√©rifier que le serveur est accessible&quot;">‚Äã</a></h4><p>Pour v√©rifier que le serveur est accessible, il vous suffit d&#39;ouvrir votre navigateur et d&#39;aller sur l&#39;adresse IP de votre serveur. Si vous avez bien suivi les √©tapes pr√©c√©dentes, vous devriez voir la page d&#39;accueil d&#39;Apache.</p><p><img src="`+t+`" alt="Page d&#39;accueil d&#39;Apache" loading="lazy"></p><details class="details custom-block"><summary>Rappel sur les dossiers</summary><p>Les fichiers du serveur sont dans le dossier <code>/var/www/html</code>. Vous pouvez y acc√©der avec la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/html</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>C&#39;est ici que nous voyons l&#39;avantage de Linux. L&#39;architecture est tr√®s simple, et les fichiers sont tr√®s facilement accessibles.</p></details><h4 id="les-permissions" tabindex="-1">Les permissions <a class="header-anchor" href="#les-permissions" aria-label="Permalink to &quot;Les permissions&quot;">‚Äã</a></h4><p>Afin que votre utilisateur puisse modifier le code de votre site, vous devez modifier les permissions du dossier <code>/var/www/html</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">VOTRE-UTILISATEU</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">R</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:www-data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="installation-de-php" tabindex="-1">Installation de PHP <a class="header-anchor" href="#installation-de-php" aria-label="Permalink to &quot;Installation de PHP&quot;">‚Äã</a></h2><p>Maintenant que nous avons un serveur Web, nous allons installer PHP. Pour l&#39;instant vous avez utilis√© PHP sur votre machine Windows (via XAMPP). Mais PHP peut √©galement √™tre install√© sur un serveur Linux. Pour cela, nous allons utiliser la commande <code>apt</code> pour installer le paquet <code>php</code>.</p><p>Debian est une distribution un peu particuli√®re, elle est dite ¬´ stable ¬ª. C&#39;est-√†-dire que les versions des paquets peuvent-√™tre un peu ancien. Pour cela nous allons devoir ajouter un d√©p√¥t suppl√©mentaire pour avoir acc√®s aux derni√®res versions de PHP.</p><p>Le D√©p√¥t est une source suppl√©mentaire pour l&#39;installation de paquets. Il est possible d&#39;ajouter plusieurs d√©p√¥ts, et de choisir la version de paquet que l&#39;on souhaite installer.</p><h3 id="etape-1-ajout-du-depot" tabindex="-1">√âtape 1 : Ajout du d√©p√¥t <a class="header-anchor" href="#etape-1-ajout-du-depot" aria-label="Permalink to &quot;√âtape 1 : Ajout du d√©p√¥t&quot;">‚Äã</a></h3><p>Nous allons donc ajouter un nouveau d√©p√¥t pour avoir acc√®s aux derni√®res versions de PHP.</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lsb-release</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-transport-https</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gnupg2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ca-certificates</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apt/trusted.gpg.d/php.gpg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://packages.sury.org/php/apt.gpg</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;echo &quot;deb https://packages.sury.org/php/ $(lsb_release -sc) main&quot; &gt; /etc/apt/sources.list.d/php.list&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Un peu de d√©tail sur les commandes :</p><ul><li><code>wget</code> est un outil qui permet de t√©l√©charger des fichiers depuis Internet.</li><li><code>lsb-release</code> est un outil qui permet de r√©cup√©rer des informations sur la distribution Linux.</li><li><code>apt-transport-https</code> est un outil qui permet de t√©l√©charger des fichiers depuis un serveur HTTPS.</li><li><code>gnupg2</code> est un outil qui permet de v√©rifier la signature d&#39;un fichier.</li><li><code>ca-certificates</code> est un outil qui permet de v√©rifier la signature d&#39;un fichier.</li><li><code>wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg</code> permet de t√©l√©charger le fichier de signature du d√©p√¥t.</li><li><code>sh -c &#39;echo &quot;deb https://packages.sury.org/php/ $(lsb_release -sc) main&quot; &gt; /etc/apt/sources.list.d/php.list&#39;</code> permet d&#39;ajouter le d√©p√¥t dans la liste des d√©p√¥ts.</li></ul><p>Le d√©p√¥t est celui de <a href="https://deb.sury.org/" target="_blank" rel="noreferrer">Ond≈ôej Sur√Ω</a>. Il est tr√®s connu pour proposer des versions de PHP plus r√©centes que celles propos√©es par Debian.</p><div class="tip custom-block"><p class="custom-block-title">cette √©tape est importante.</p><p>Si vous ne faites pas cette √©tape, vous n&#39;aurez pas acc√®s aux derni√®res versions de PHP. Vous aurez donc une version de PHP qui n&#39;est pas √† jour, et qui ne sera pas compatible avec les derni√®res versions fonctionnalit√©s de PHP. Car oui, de base Debian va poss√©der l&#39;ensemble des paquets qui nous seront utiles, mais dans une version un peu plus ancienne (mais plus stable du coup).</p></div><h3 id="etape-2-installation-de-php" tabindex="-1">√âtape 2 : Installation de PHP <a class="header-anchor" href="#etape-2-installation-de-php" aria-label="Permalink to &quot;√âtape 2 : Installation de PHP&quot;">‚Äã</a></h3><p>Maintenant que nous avons ajout√© le d√©p√¥t, nous allons pouvoir installer PHP.</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-fpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-{bz2,curl,mbstring,intl,pdo,mysql,gd,xml}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>√áa fait beaucoup de paquets, mais en fait, c&#39;est tr√®s simple. Voici le d√©tail pour quelques paquets :</p><ul><li><code>php8.2</code> est le paquet principal de PHP.</li><li><code>php8.2-fpm</code> est le paquet qui permet de faire tourner PHP en tant que service.</li><li><code>php8.2-cli</code> est le paquet qui permet d&#39;utiliser PHP en ligne de commande.</li><li><code>php8.2-{bz2,curl,mbstring,intl}</code> sont des paquets qui permettent d&#39;ajouter des fonctionnalit√©s √† PHP.</li></ul><div class="tip custom-block"><p class="custom-block-title">pourquoi autant de paquets ?</p><p>C&#39;est un peu compliqu√© √† expliquer, mais en gros, PHP est un langage qui est tr√®s modulaire. C&#39;est-√†-dire qu&#39;il est possible de choisir les fonctionnalit√©s que l&#39;on souhaite utiliser. C&#39;est pour cela que nous avons besoin de plusieurs paquets pour avoir une version compl√®te de PHP.</p><p>Il est possible que plus tard pour un d√©veloppement vous ayez besoin d&#39;ajouter de nouveaux paquets, c&#39;est le cas par exemple pour un Wordpress / Laravel.</p></div><h4 id="petit-aparte-sur-php-fpm" tabindex="-1">Petit apart√© sur PHP-fpm <a class="header-anchor" href="#petit-aparte-sur-php-fpm" aria-label="Permalink to &quot;Petit apart√© sur PHP-fpm&quot;">‚Äã</a></h4><p>PHP-FPM est un outil qui permet de faire tourner PHP en tant que service. C&#39;est-√†-dire que PHP va tourner en arri√®re plan, et que les pages Web vont √™tre g√©n√©r√©es par PHP. C&#39;est un peu comme si vous aviez un serveur Apache, et un serveur PHP qui tourne en arri√®re plan. C&#39;est la nouvelle fa√ßon de faire tourner PHP.</p><p>üëã C&#39;est surtout la bonne fa√ßon de le faire fonctionner en 2023 (m√™me si les autres fa√ßons fonctionnent √©videmment encore).</p><h4 id="verifier-la-version-de-php" tabindex="-1">V√©rifier la version de PHP <a class="header-anchor" href="#verifier-la-version-de-php" aria-label="Permalink to &quot;V√©rifier la version de PHP&quot;">‚Äã</a></h4><p>Maintenant que nous avons install√© PHP, nous pouvons le v√©rifier via la commande :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Vous devriez voir quelque chose similaire √† :</p><p><img src="`+m+`" alt="Version de PHP" loading="lazy"></p><h3 id="etape-3-activer-php-dans-apache" tabindex="-1">√âtape 3 : Activer PHP dans Apache <a class="header-anchor" href="#etape-3-activer-php-dans-apache" aria-label="Permalink to &quot;√âtape 3 : Activer PHP dans Apache&quot;">‚Äã</a></h3><p>Maintenant que notre PHP est install√©, il faut l&#39;activer :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a2enmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> proxy_fcgi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setenvif</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rewrite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> headers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a2enconf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-fpm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Que font ces commandes ?</p><ul><li><code>a2enmod proxy_fcgi setenvif rewrite</code> permet d&#39;activer les modules Apache qui vont nous permettre d&#39;utiliser PHP. <ul><li><code>proxy_fcgi</code> est le module qui permet d&#39;utiliser PHP-FPM (mode FastCGI).</li><li><code>setenvif</code> est le module qui permet d&#39;envoyer des variables d&#39;environnement √† PHP.</li><li><code>rewrite</code>est le module qui permet de faire de la r√©√©criture d&#39;URL, c&#39;est tr√®s utile pour les frameworks.</li></ul></li><li><code>a2enconf php8.2-fpm</code> permet d&#39;activer la configuration de PHP dans Apache.</li><li><code>systemctl restart apache2</code> permet de red√©marrer Apache, pour prendre en compte les modifications.</li></ul><p>Pour v√©rifier que Apache + PHP fonctionne, vous pouvez cr√©er un fichier <code>info.php</code> dans le dossier <code>/var/www/html</code>. Vous pouvez utiliser la commande suivante pour y acc√©der :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/html/info.php</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Dans ce fichier <code>info.php</code>, vous pouvez mettre le code suivant :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">phpinfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Vous pouvez ensuite ouvrir votre navigateur et aller sur l&#39;adresse IP de votre serveur. Si vous avez bien suivi les √©tapes pr√©c√©dentes, vous devriez voir la page d&#39;information de PHP.</p><div class="tip custom-block"><p class="custom-block-title">phpinfo() ?</p><p>La fonction <code>phpinfo()</code> permet d&#39;afficher les informations de PHP. C&#39;est tr√®s pratique pour v√©rifier que tout fonctionne correctement. Vous pouvez √©galement utiliser cette fonction pour v√©rifier que les extensions PHP sont bien install√©es.</p><p>Comme par exemple <code>php-pdo</code> et <code>php-mysql</code> pour la base de donn√©es.</p></div><div class="danger custom-block"><p class="custom-block-title">Attention</p><p>Ce fichier dangereux, ne pas laisser ce fichier sur un serveur en production. Il permet d&#39;afficher des informations sensibles sur le serveur. En effet, il est possible d&#39;avoir des informations sur les modules install√©s, les versions de PHP, les extensions install√©es, etc. Il est donc tr√®s important de ne pas laisser ce fichier sur un serveur en production.</p><p>üö® Ne <strong>JAMAIS</strong> laisser un <code>phpinfo()</code> sur un serveur en production, <strong>JAMAIS</strong>.</p></div><h2 id="conclusion-intermediaire" tabindex="-1">Conclusion interm√©diaire <a class="header-anchor" href="#conclusion-intermediaire" aria-label="Permalink to &quot;Conclusion interm√©diaire&quot;">‚Äã</a></h2><p>Nous avons donc install√© Apache, MySQL et PHP. Nous avons √©galement configur√© Apache pour qu&#39;il puisse utiliser PHP. Nous avons √©galement install√© les extensions PHP qui nous seront utiles pour le d√©veloppement.</p><p>C&#39;est un point √©tape, votre serveur est maintenant pr√™t pour le d√©veloppement. Avant de continuer, nous allons voir comment est configur√© un serveur Web (PHP).</p><h2 id="la-configuration-de-php" tabindex="-1">La configuration de PHP <a class="header-anchor" href="#la-configuration-de-php" aria-label="Permalink to &quot;La configuration de PHP&quot;">‚Äã</a></h2><p>La configuration de PHP se fait via le fichier <code>/etc/php/8.2/fpm/php.ini</code>. Vous pouvez l&#39;ouvrir avec la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/php/8.2/fpm/php.ini</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Vous trouverez dans ce fichier toutes les options de configuration de PHP. Vous pouvez par exemple modifier la taille de la m√©moire allou√©e √† PHP, ou encore modifier le temps d&#39;ex√©cution d&#39;un script PHP.</p><p>Pour l&#39;instant, nous allons seulement activer les erreurs PHP. Pour cela, il faut modifier la ligne suivante :</p><div class="language-ini vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">display_errors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = Off</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>En :</p><div class="language-ini vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">display_errors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = On</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Ensuite, il faut red√©marrer le service PHP :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-fpm</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>√Ä partir de maintenant, les erreurs PHP seront affich√©es dans le navigateur, et non plus dans le fichier <code>error.log</code> d&#39;Apache.</p><div class="tip custom-block"><p class="custom-block-title">Un petit mot sur les logs</p><p>Nous avons construit un serveur Web de d√©veloppement. C&#39;est-√†-dire que nous avons un serveur Web qui va tourner en local, et qui va servir uniquement √† d√©velopper des sites Web.</p><p>Le mot important ici est <strong>d√©veloppement</strong>. En effet, sur un serveur de production, √† l&#39;inverse, nous ne voulons pas que les logs s&#39;affichent dans le navigateur du client. Nous ne changerons donc pas la configuration de PHP pour afficher les erreurs PHP dans le navigateur.</p></div><h2 id="la-configuration-d-apache" tabindex="-1">La configuration d&#39;Apache <a class="header-anchor" href="#la-configuration-d-apache" aria-label="Permalink to &quot;La configuration d&#39;Apache&quot;">‚Äã</a></h2><p>Actuellement, votre serveur tourne avec la configuration par d√©faut d&#39;Apache. C&#39;est-√†-dire que vous avez un seul site Web qui est accessible sur le port 80. Nous allons maintenant voir comment cr√©er plusieurs sites Web, et comment les configurer.</p><p>Pour tester le principe des VirtualHost, nous allons cr√©er deux sites Internet sur notre serveur :</p><ul><li><code>&lt;votre-ip&gt;:80</code> : va afficher le site pr√©sent dans <code>/var/www/siteA/</code></li><li><code>&lt;votre-ip&gt;:8080</code> : va afficher le site pr√©sent dans <code>/var/www/siteB/</code></li></ul><p><img src="`+v+`" alt="VirtualHost" loading="lazy"></p><div class="tip custom-block"><p class="custom-block-title">Port ou Domaine ?</p><p>Au lyc√©e nous allons faire des virtualhost avec des ports. En effet, nous n&#39;avons pas acc√®s √† la configuration DNS du lyc√©e, et nous ne pouvons donc pas cr√©er des domaines.</p><p>En production, vous pouvez utiliser des domaines, ou des ports. C&#39;est √† vous de voir ce qui vous convient le mieux.</p><p>Utiliser des domaines est plus joli, car nous pourrions avoir des URL de type :</p><ul><li><code>siteA.monsite.com</code></li><li><code>siteB.monsite.com</code></li></ul><p>C&#39;est quelque chose que nous retrouvons sur les sites Web professionnels. C&#39;est plus joli, et c&#39;est plus facile √† retenir pour les utilisateurs.</p></div><h3 id="creer-les-dossiers" tabindex="-1">Cr√©er les dossiers <a class="header-anchor" href="#creer-les-dossiers" aria-label="Permalink to &quot;Cr√©er les dossiers&quot;">‚Äã</a></h3><p>Nous allons cr√©er deux dossiers dans <code>/var/www</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/siteA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/siteB</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="creer-les-fichiers-de-configuration" tabindex="-1">Cr√©er les fichiers de configuration <a class="header-anchor" href="#creer-les-fichiers-de-configuration" aria-label="Permalink to &quot;Cr√©er les fichiers de configuration&quot;">‚Äã</a></h3><p>Nous allons maintenant cr√©er deux fichiers de configuration pour nos deux sites Web. Nous allons les cr√©er dans le dossier <code>/etc/apache2/sites-available/</code>.</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apache2/sites-available/siteA.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Dans ce fichier, nous allons mettre le code suivant :</p><div class="language-apache vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">apache</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VirtualHost</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> *:8080</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    DocumentRoot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /var/www/siteA</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ErrorLog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \${APACHE_LOG_DIR}/siteA-error.log</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    CustomLog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \${APACHE_LOG_DIR}/siteA-access.log combined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VirtualHost</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Ensuite, nous allons cr√©er le fichier de configuration pour le site B :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apache2/sites-available/siteB.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Dans ce fichier, nous allons mettre le code suivant :</p><div class="language-apache vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">apache</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VirtualHost</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> *:8181</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    DocumentRoot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /var/www/siteB</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ErrorLog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \${APACHE_LOG_DIR}/siteB-error.log</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    CustomLog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \${APACHE_LOG_DIR}/siteB-access.log combined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VirtualHost</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">qu&#39;observez-vous ?</p><p>Ici les deux fichiers de configuration sont tr√®s similaires. La seule diff√©rence est le port sur lequel le site est accessible. Nous avons donc deux sites Web qui sont accessibles sur deux ports diff√©rents.</p><p><img src="`+l+`" alt="VirtualHost" loading="lazy"></p><p>Vous pouvez voir que nous avons √©galement configur√© les logs d&#39;Apache. Nous avons donc deux fichiers de logs diff√©rents pour chaque site Web. Cela nous permet de savoir quel site Web a g√©n√©r√© une erreur.</p></div><h3 id="activer-les-sites-web" tabindex="-1">Activer les sites Web <a class="header-anchor" href="#activer-les-sites-web" aria-label="Permalink to &quot;Activer les sites Web&quot;">‚Äã</a></h3><p>Nous avons cr√©√© deux fichiers de configuration, mais ils ne sont pas encore activ√©s. Pour les activer, nous allons utiliser la commande <code>a2ensite</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a2ensite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> siteA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a2ensite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> siteB</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>a2ensite</code> ? Cette commande va permettre d&#39;activer les site web que vous avez cr√©√© dans le dossier <code>/etc/apache2/sites-available/</code>. Cette commande va cr√©er un lien symbolique dans le dossier <code>/etc/apache2/sites-enabled/</code>.</p><p>Un lien symbolique est un fichier qui pointe vers un autre fichier, c&#39;est un peu comme un raccourci. Dans notre cas, le lien symbolique va pointer vers le fichier de configuration du site Web.</p><h3 id="desactiver-les-sites-web" tabindex="-1">D√©sactiver les sites Web <a class="header-anchor" href="#desactiver-les-sites-web" aria-label="Permalink to &quot;D√©sactiver les sites Web&quot;">‚Äã</a></h3><p>Si vous voulez d√©sactiver un site Web, vous pouvez utiliser la commande <code>a2dissite</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a2dissite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> siteA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a2dissite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> siteB</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Cette commande va supprimer le lien symbolique dans le dossier <code>/etc/apache2/sites-enabled/</code>.</p><h3 id="ecouter-sur-plusieurs-ports" tabindex="-1">√âcouter sur plusieurs ports <a class="header-anchor" href="#ecouter-sur-plusieurs-ports" aria-label="Permalink to &quot;√âcouter sur plusieurs ports&quot;">‚Äã</a></h3><p>Par d√©faut, Apache √©coute sur le port 80. Nous allons donc modifier la configuration d&#39;Apache pour qu&#39;il puisse √©couter sur plusieurs ports.</p><p>Pour cela, nous allons modifier le fichier <code>/etc/apache2/ports.conf</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apache2/ports.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Nous allons modifier la ligne suivante :</p><div class="language-apache vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">apache</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Listen</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>En :</p><div class="language-apache vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">apache</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Listen</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Listen</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8080</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Listen</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8181</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">ici nous avons</p><ul><li><code>Listen 80</code> : le port par d√©faut d&#39;Apache</li><li><code>Listen 8181</code> : le port sur lequel le site A est accessible</li><li><code>Listen 8080</code> : le port sur lequel le site B est accessible</li></ul><p>Si nous voulions ajouter un troisi√®me site Web, nous aurions donc ajout√© une ligne <code>Listen 8282</code> dans le fichier <code>ports.conf</code>. Ou tout autre port libre sur le serveur.</p></div><h3 id="redemarrer-apache" tabindex="-1">Red√©marrer Apache <a class="header-anchor" href="#redemarrer-apache" aria-label="Permalink to &quot;Red√©marrer Apache&quot;">‚Äã</a></h3><p>Nous avons modifi√© la configuration d&#39;Apache, il faut donc red√©marrer le service :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="tester-les-sites-web" tabindex="-1">Tester les sites Web <a class="header-anchor" href="#tester-les-sites-web" aria-label="Permalink to &quot;Tester les sites Web&quot;">‚Äã</a></h3><p>Nous allons maintenant tester les sites Web. Pour cela, nous allons utiliser un navigateur Web. Nous allons ouvrir deux onglets, et nous allons taper les URL suivantes :</p><ul><li><code>http://&lt;votre-ip&gt;:8080</code></li><li><code>http://&lt;votre-ip&gt;:8181</code></li></ul><p>Vous devriez voir les deux sites Web :</p><p><img src="`+k+`" alt="VirtualHost" loading="lazy"></p><div class="tip custom-block"><p class="custom-block-title">Qu&#39;observez-vous ?</p><p>Nous avons deux sites Web qui sont accessibles, mais pour le moment ils sont vides. Vu que nous n&#39;avons pas encore mis de <code>index.html</code> ou <code>index.php</code> dans les dossiers apache nous liste les fichiers pr√©sents dans le dossier.</p></div><h3 id="masquer-les-fichiers-presents-dans-le-dossier" tabindex="-1">Masquer les fichiers pr√©sents dans le dossier <a class="header-anchor" href="#masquer-les-fichiers-presents-dans-le-dossier" aria-label="Permalink to &quot;Masquer les fichiers pr√©sents dans le dossier&quot;">‚Äã</a></h3><p>Si vous souhaitez que Apache ne liste pas les fichiers pr√©sents dans le dossier, vous pouvez ajouter la ligne suivante dans le fichier de configuration du site Web (√† l&#39;int√©rieur de la balise <code>&lt;VirtualHost&gt;</code>), exemple pour le site A :</p><div class="language-apache vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">apache</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Directory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/siteA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -Indexes +FollowSymLinks</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    AllowOverride</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> All</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    Require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> all granted</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Directory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Puis red√©marrer Apache :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Vous devriez maintenant avoir une page vous indiquant que le site est inaccessible :</p><p><img src="`+b+'" alt="VirtualHost" loading="lazy"></p><div class="tip custom-block"><p class="custom-block-title">Qu&#39;observez-vous ?</p><p>L&#39;option importante dans le fichier de configuration est <code>Options -Indexes</code>. Cette option permet de masquer les fichiers pr√©sents dans le dossier. Pour lister √† nouveau les fichiers, vous pouvez supprimer cette option.</p></div><h2 id="creer-un-site-web" tabindex="-1">Cr√©er un site Web <a class="header-anchor" href="#creer-un-site-web" aria-label="Permalink to &quot;Cr√©er un site Web&quot;">‚Äã</a></h2><p>Notre serveur Apache est maintenant configur√©, et permet m√™me de cr√©er plusieurs sites Web. Pour valider son bon fonctionnement, nous allons cr√©er trois sites Web :</p><ul><li>Sur le port <code>80</code>: Une page listant les diff√©rents sites Web (site A et site B).</li><li>Sur le port <code>8080</code> : Une page en PHP qui affiche le nom du serveur (centr√© au milieu de la page et en gras et gros).</li><li>Sur le port <code>8181</code> : Une page en PHP qui liste les fichiers pr√©sents dans le dossier <code>/var/www/siteB</code>.</li></ul><h2 id="comment-travailler-avec-le-serveur" tabindex="-1">Comment travailler avec le serveur ? <a class="header-anchor" href="#comment-travailler-avec-le-serveur" aria-label="Permalink to &quot;Comment travailler avec le serveur ?&quot;">‚Äã</a></h2><p>Pour r√©aliser cette partie, nous avons deux possibilit√©s :</p><ul><li>Travailler directement sur le serveur.</li><li>Travailler sur votre machine, et copier les fichiers sur le serveur.</li></ul><div class="danger custom-block"><p class="custom-block-title">Travailler sur le serveur == Danger</p><p>Travailler sur le serveur peut sembler int√©ressant, mais il y a un gros inconv√©nient : si vous faites une erreur, vous allez devoir tout recommencer. Je vous conseille donc de travailler sur votre machine, et de copier les fichiers sur le serveur.</p></div><h3 id="travailler-sur-votre-machine" tabindex="-1">Travailler sur votre machine <a class="header-anchor" href="#travailler-sur-votre-machine" aria-label="Permalink to &quot;Travailler sur votre machine&quot;">‚Äã</a></h3><p>Pour travailler sur votre machine, vous avez plusieurs solutions :</p><ul><li>Coder en local comme habituellement, puis p√©riodiquement copier les fichiers sur le serveur (√† l&#39;aide d&#39;un <strong>client SFTP</strong>, comme FileZilla par exemple).</li><li>Coder en local en utilisant <strong>Git</strong>, puis cloner le d√©p√¥t sur le serveur (ou le puller si vous avez d√©j√† un d√©p√¥t sur le serveur).</li></ul><p>Les deux solutions sont valables, mais je vous conseille d&#39;utiliser Git. Cela vous permettra de travailler sur plusieurs projets en m√™me temps, et de les g√©rer facilement.</p><h3 id="les-clients-sftp" tabindex="-1">Les clients SFTP <a class="header-anchor" href="#les-clients-sftp" aria-label="Permalink to &quot;Les clients SFTP&quot;">‚Äã</a></h3><p>Il existe plusieurs clients SFTP :</p><ul><li>FileZilla : <a href="https://filezilla-project.org/" target="_blank" rel="noreferrer">https://filezilla-project.org/</a> (d√©j√† install√© sur les ordinateurs du lyc√©e)</li><li>WinSCP : <a href="https://winscp.net/eng/index.php" target="_blank" rel="noreferrer">https://winscp.net/eng/index.php</a> (minimaliste, mais tr√®s efficace)</li></ul><p>Ces deux clients sont gratuits et utilisent le SSH pour se connecter au serveur. Pour vous connecter, vous devez renseigner les informations suivantes :</p><ul><li><strong>Host</strong> : l&#39;adresse IP du serveur</li><li><strong>Username</strong> : votre nom d&#39;utilisateur</li><li><strong>Port</strong> : 22 (le port SSH)</li></ul><p>Et pas de mot de passe‚Ä¶ Et oui, nous avons configur√© le serveur pour ne pas demander de mot de passe. Pour vous connecter, vous devez utiliser une <strong>cl√© SSH</strong>. Pour √ßa vous devez :</p><ul><li>√âdition &gt; Param√®tres &gt; Connexion&gt; SFTP &gt; Ajouter un fichier de cl√©.</li></ul><p><img src="'+r+'" alt="FileZilla" loading="lazy"><img src="'+p+`" alt="FileZilla" loading="lazy"></p><h3 id="via-git" tabindex="-1">Via Git <a class="header-anchor" href="#via-git" aria-label="Permalink to &quot;Via Git&quot;">‚Äã</a></h3><p>J&#39;aime beaucoup l&#39;id√©e de travailler avec Git pour ce genre de situation. Vous pouvez cr√©er un d√©p√¥t sur votre machine, et le cloner sur le serveur, puis continuer √† travailler sur votre machine et puller les modifications sur le serveur r√©guli√®rement.</p><p>La proc√©dure sera la suivante :</p><ul><li>Installer Git sur le serveur : <code>apt install git</code>.</li><li>Cr√©er un d√©p√¥t sur votre machine et le partager sur Github / Gitlab.</li><li>Cloner le d√©p√¥t sur le serveur : <code>git clone &lt;url&gt;</code>. (apr√®s avoir g√©n√©r√© une cl√© SSH sur le serveur, et l&#39;avoir ajout√©e √† votre compte Github / Gitlab <a href="/cheatsheets/ssh-key/">voir la proc√©dure</a>).</li><li>Travailler sur votre machine les pusher r√©guli√®rement</li><li>Puller les modifications sur le serveur.</li></ul><p>Voil√† un exemple complet de proc√©dure sur le serveur :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Installation de Git</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Cr√©ation d&#39;un dossier pour le projet</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/siteA</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/siteA</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># clone du d√©p√¥t de votre projet, le . √† la fin est important, il permet de cloner le d√©p√¥t dans le dossier courant (ici /var/www/siteA)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git@gitlab.com:c4software/votre-projet-deja-existant.git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PLUS TARD</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Vous pouvez maintenant travailler sur votre machine</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># et pusher les modifications sur le serveur</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Pour puller les modifications sur le serveur</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/siteA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">faignant ?</p><p>Et vu que nous sommes faignants, voici un script pour g√©rer les mises √† jour. Cr√©ez un fichier <code>update.sh</code> dans le dossier de votre choix (dans votre dossier personnel de votre serveur), et mettez-y le code suivant :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/siteA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Vous pourrez lancer ce script avec la commande <code>./update.sh</code>. Attention, il faut que le script soit ex√©cutable (<code>chmod +x update.sh</code>).</p></div><h3 id="site-web-sur-le-port-80" tabindex="-1">Site Web sur le port 80 <a class="header-anchor" href="#site-web-sur-le-port-80" aria-label="Permalink to &quot;Site Web sur le port 80&quot;">‚Äã</a></h3><p>Pour cette partie je vous laisse faire. Vous devez modifier le fichier <code>index.html</code> dans le dossier <code>/var/www/html</code>.</p><h3 id="site-web-sur-le-port-8080" tabindex="-1">Site Web sur le port 8080 <a class="header-anchor" href="#site-web-sur-le-port-8080" aria-label="Permalink to &quot;Site Web sur le port 8080&quot;">‚Äã</a></h3><p>Pour cette partie, vous allez cr√©er un fichier <code>index.php</code> dans le dossier <code>/var/www/siteA</code>. Ce fichier devra afficher le nom du serveur (centr√© et en gras, en utilisant <code>flexbox</code>).</p><p>Je vous aide un peu, pour obtenir le nom du serveur, vous pouvez utiliser la fonction <code>gethostname()</code> de PHP :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $serverName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gethostname</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>Centrer un √©l√©ment au milieu de la page : <a href="https://css-tricks.com/centering-css-complete-guide/" target="_blank" rel="noreferrer">https://css-tricks.com/centering-css-complete-guide/</a></li><li>Documentation flexbox : <a href="https://css-tricks.com/snippets/css/a-guide-to-flexbox/" target="_blank" rel="noreferrer">https://css-tricks.com/snippets/css/a-guide-to-flexbox/</a></li></ul><h3 id="site-web-sur-le-port-8181" tabindex="-1">Site Web sur le port 8181 <a class="header-anchor" href="#site-web-sur-le-port-8181" aria-label="Permalink to &quot;Site Web sur le port 8181&quot;">‚Äã</a></h3><p>Pour cette partie, vous allez cr√©er un fichier <code>index.php</code> dans le dossier <code>/var/www/siteB</code>. Pour lister les fichiers pr√©sents dans le dossier, vous pouvez utiliser la fonction <code>scandir()</code> de PHP :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $files </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> scandir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    foreach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($files </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $file) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $file </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&lt;br&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Je vous laisse r√©fl√©chir pour l&#39;affichage du r√©sultat.</p><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">‚Äã</a></h2><p>Dans ce TP / TD nous avons vu comment configurer Apache pour qu&#39;il puisse int√©grer le PHP et √©galement comment h√©berger plusieurs sites Web sur un m√™me serveur.</p><p>Ce TP est loin d&#39;√™tre exhaustif, mais il vous permettra de vous familiariser avec Apache et le PHP. Si vous souhaitez une synth√®se (sans commentaire) de ce TP, vous pouvez consulter le fichier suivant : <a href="/cheatsheets/serveur/debian-web.html">Debian Web.</a></p><h2 id="liens-utiles" tabindex="-1">Liens utiles <a class="header-anchor" href="#liens-utiles" aria-label="Permalink to &quot;Liens utiles&quot;">‚Äã</a></h2><ul><li>Documentation Apache : <a href="https://httpd.apache.org/docs/2.4/" target="_blank" rel="noreferrer">https://httpd.apache.org/docs/2.4/</a></li><li>Documentation PHP : <a href="https://www.php.net/manual/fr/" target="_blank" rel="noreferrer">https://www.php.net/manual/fr/</a></li><li>Documentation VirtualHost : <a href="https://httpd.apache.org/docs/2.4/vhosts/" target="_blank" rel="noreferrer">https://httpd.apache.org/docs/2.4/vhosts/</a></li></ul>`,177);function T(L,W,M,I,j,N){const a=c("Badge");return d(),u("div",null,[f,e("details",F,[y,e("nav",C,[e("ul",null,[P,E,q,e("li",null,[A,e("ul",null,[B,e("li",null,[e("a",w,[s("Cr√©ation de la VM via un mod√®le "),n(a,{type:"tip",text:"Meilleure solution",vertical:"top"})])]),x,_])]),H])])]),V,e("h3",z,[s("Cr√©ation de la VM via un mod√®le "),n(a,{type:"tip",text:"Meilleure solution",vertical:"top"}),s(),D]),S])}const $=o(g,[["render",T]]);export{U as __pageData,$ as default};
