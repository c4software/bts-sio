import{_ as i,c as a,o as n,U as e,k as s}from"./chunks/framework.aGaNZw_P.js";const t="/assets/open_project.C5L_Rty2.png",l="/assets/structures.BF0QxYp8.png",r="/assets/MVVMPattern.CWET_G7F.png",p="/assets/create_package.CHCm14GN.png",o="/assets/add_manifest.C8Knqeuz.png",A=JSON.parse(`{"title":"Explication structure Â« Android Boilerplate Â»","description":"Ce document n'est pas un TP, mais une explication de la structure Â« Android Boilerplate Â»","frontmatter":{"description":"Ce document n'est pas un TP, mais une explication de la structure Â« Android Boilerplate Â»"},"headers":[],"relativePath":"tp/android/sample-explication.md","filePath":"tp/android/sample-explication.md","lastUpdated":1640899309000}`),d={name:"tp/android/sample-explication.md"},c=e('<h1 id="explication-structure-Â«-android-boilerplate-Â»" tabindex="-1">Explication structure Â« Android Boilerplate Â» <a class="header-anchor" href="#explication-structure-Â«-android-boilerplate-Â»" aria-label="Permalink to &quot;Explication structure Â« Android Boilerplate Â»&quot;">â€‹</a></h1><p>Ce document n&#39;est pas un TP, mais une explication de la structure Â« Android Boilerplate Â» disponible Ã  l&#39;adresse suivante :</p><ul><li><a href="https://github.com/c4software/Android-Boilerplate-Koin-CoRoutines-OkHTTP" target="_blank" rel="noreferrer">Android Boilerplate Koin - Rx - OkHttp</a></li></ul><p>Ce document vous donnera les clÃ©s afin de comprendre le fonctionnement et de vous l&#39;approprier.</p><div class="danger custom-block"><p class="custom-block-title">XML ou Compose ?</p><p>Nous sommes en 2021, le monde d&#39;Android Ã©volueâ€¦ Pendant des annÃ©es l&#39;Ã©criture des Â« layouts Â» (interface) n&#39;Ã©tait possible que via du XML. Il est maintenant possible d&#39;Ã©crire les layouts de maniÃ¨res bien plus modernes avec <a href="https://developer.android.com/jetpack/compose" target="_blank" rel="noreferrer">JetPack Compose</a>. Le TP que vous suivez est toujours valide, mais repose sur l&#39;utilisation de XML.</p></div><h2 id="but-du-code" tabindex="-1">But du code <a class="header-anchor" href="#but-du-code" aria-label="Permalink to &quot;But du code&quot;">â€‹</a></h2><p>Le but du code fourni sur Github est de simplifier la mise en place d&#39;une base applicative Android Â« moderne Â». Il ne contient aucun code (presque). Il est donc clonnable / tÃ©lÃ©chargeable et utilisable tel quel, l&#39;idÃ©e Ã©tant vraiment d&#39;avoir presque un template d&#39;application rÃ©utilisable Ã  volontÃ©.</p><p>Ceci Ã©tant annoncÃ©, passons au dÃ©tail du fonctionnement.</p><h2 id="recuperer-le-code" tabindex="-1">RÃ©cupÃ©rer le code <a class="header-anchor" href="#recuperer-le-code" aria-label="Permalink to &quot;RÃ©cupÃ©rer le code&quot;">â€‹</a></h2><p>Pour rÃ©cupÃ©rer le code source, vous avez deux possibilitÃ©s :</p><ul><li>Le fichier zip en provenance de Github : <a href="https://github.com/c4software/Android-Boilerplate-Koin-CoRoutines-OkHTTP/archive/master.zip" target="_blank" rel="noreferrer">Ã€ tÃ©lÃ©charger ici</a></li><li>En clonant le repository : <code>git clone git@github.com:c4software/Android-Boilerplate-Koin-CoRoutines-OkHTTP.git</code></li></ul><p>âš ï¸ Attention, si vous avez choisi de cloner le repository. Pensez bien Ã  supprimer le dossier <code>.git</code> Ã  la racine des sources afin de ne pas garder l&#39;historique de mon projet. âš ï¸</p><h2 id="lancer-le-projet-une-premiere-fois" tabindex="-1">Lancer le projet une premiÃ¨re fois <a class="header-anchor" href="#lancer-le-projet-une-premiere-fois" aria-label="Permalink to &quot;Lancer le projet une premiÃ¨re fois&quot;">â€‹</a></h2><p>Avant d&#39;effectuer des modifications dans le projet, nous allons le lancer une premiÃ¨re fois. Pour Ã§a, il suffit d&#39;ouvrir le projet avec Android Studio.</p><p><img src="'+t+'" alt="Ouvrir le projet" loading="lazy"></p><p>Une fois l&#39;indexation terminÃ©e, vous devez pouvoir lancer le projet sur un Ã©mulateur ou sur votre tÃ©lÃ©phone. Ce qui devrait donner quelque chose comme :</p><p><img src="https://github.com/c4software/Android-Boilerplate-Koin-CoRoutines-OkHTTP/blob/master/capture.png?raw=true" alt="Demo" loading="lazy"></p><h2 id="la-structure-des-dossiers" tabindex="-1">La structure des dossiers <a class="header-anchor" href="#la-structure-des-dossiers" aria-label="Permalink to &quot;La structure des dossiers&quot;">â€‹</a></h2><p>Afin de simplifier l&#39;entrÃ©e dans le code, j&#39;ai volontairement limitÃ© l&#39;organisation des dossiers au strict minimum. Attention, Ã§a ne veut pas dire que vous ne pouvez pas en crÃ©er d&#39;autres pour organiser votre code au mieux.</p><p><img src="'+l+'" alt="structure dossier" loading="lazy"></p><ul><li><code>data</code> : Contiens la dÃ©finition (interface) de vos sources de donnÃ©es (exemple la dÃ©finition des appels rÃ©seau).</li><li><code>di</code> : La dÃ©finition des Ã©lÃ©ments qui sont Â« injectÃ©s Â».</li><li><code>domain</code> : Votre code mÃ©tier, celui qui fait le traitement (soit local, ou alors les appels aux APIs HTTP par exemple)</li><li><code>utils</code> : L&#39;ensemble de vos Â« helpers Â» / fonctions que vous vous servez Ã  plusieurs endroits dans votre code.</li><li><code>view</code> : Vos Â« vues Â», c&#39;est-Ã -dire vos diffÃ©rents Ã©crans de votre application.</li></ul><h2 id="mvvm-kezako" tabindex="-1">MVVM ? KÃ©zako !? <a class="header-anchor" href="#mvvm-kezako" aria-label="Permalink to &quot;MVVM ? KÃ©zako !?&quot;">â€‹</a></h2><p>Lâ€™acronyme MVVM signifie ModÃ¨le Vue Vue-ModÃ¨le (Modelâ€“viewâ€“viewmodel). L&#39;architecture MVVM est Â« plutÃ´t rÃ©cente Â» elle date de 2004, elle est inventÃ©e Ã  la base par Microsoft afin de simplifier les problÃ©matiques de gestion de l&#39;interface (en utilisant des mÃ©caniques d&#39;Ã©vÃ¨nement)</p><p>Elle a rÃ©cemment Ã©tÃ© popularisÃ©e par certains frameworks JavaScript, car elle permet d&#39;implÃ©menter Â« simplement Â» des interfaces avec une rÃ©activitÃ© importante.</p><p><img src="'+r+`" alt="MVVM Pattern" loading="lazy"></p><p>Cette mÃ©thode permet, tel le modÃ¨le MVC (modÃ¨le-vue-contrÃ´leur), de sÃ©parer la vue de la logique et de l&#39;accÃ¨s aux donnÃ©es en accentuant les principes de liaison et dâ€™Ã©vÃ¨nement.</p><p>Il faut donc distinguer <em>3 parties</em> :</p><ul><li>Le modÃ¨le : Les donnÃ©es au sens pures (de la data sous forme d&#39;objet), elles peuvent provenir d&#39;API, de base de donnÃ©es, de sources locales.</li><li>La vue : L&#39;affichage utilisÃ© utilisateur, la gestion des clicksâ€¦ Et <em>uniquement</em> Ã§a, la logique associÃ©e Ã  la donnÃ©e est effectuÃ©e dans le <code>Vue-ModÃ¨le</code> (via Â« le bus des Ã©vÃ¨nements Â»)</li><li>Le Vue-ModÃ¨le : IntÃ©ragie avec la couche <code>modÃ¨le</code> et envoi les nouveaux Ã©tats rÃ©sultat Ã  la vue (via le Â« bus des Ã©vÃ¨nements Â»).</li></ul><p>Nous allons, donc devoir dÃ©finir Â« des Â» bus de communication entre le Vue-ModÃ¨le et la Vue afin de permettre l&#39;actualisation des donnÃ©es. Cette organisation vous nous permettre une fois en place de ne manipuler essentiellement plus que de la donnÃ©e. La vue sera donc Â« automatiquement Â» mise Ã  jour, et ce en fonction de l&#39;Ã©tat de la donnÃ©e (exemple les loaders / les mises Ã  jour de liste, etc.)</p><p>ğŸ“–Pour ceux ayant dÃ©jÃ  fait du VueJS (ou autre framework JavaScript rÃ©cent), le dÃ©coupage est trÃ¨s proche, vous ne serez pas perdu.</p><h2 id="di-injection-de-dependances-koin-quelques-explications" tabindex="-1">DI ? Injection de dÃ©pendances, Koin quelques explications <a class="header-anchor" href="#di-injection-de-dependances-koin-quelques-explications" aria-label="Permalink to &quot;DI ? Injection de dÃ©pendances, Koin quelques explications&quot;">â€‹</a></h2><p>En introduction j&#39;ai indiquÃ© que mon Â« Boilerplate Â» Ã©tait le strict minimum viable pour un projetâ€¦ Et bien je vous ai menti ! Mais garder confiance c&#39;est pour votre bienâ€¦</p><p>Alors, l&#39;injection des dÃ©pendances petite dÃ©finition Wikipedia :</p><blockquote><p>Il consiste Ã  crÃ©er dynamiquement (injecter) les dÃ©pendances entre les diffÃ©rents objets en s&#39;appuyant sur une description (fichier de configuration ou mÃ©tadonnÃ©es) ou de maniÃ¨re programmatique. Ainsi les dÃ©pendances entre composants logiciels ne sont plus exprimÃ©es dans le code de maniÃ¨re statique, mais dÃ©terminÃ©es dynamiquement Ã  l&#39;exÃ©cution.</p></blockquote><p>Pour faire simple, le but est de ne plus avoir Ã  crÃ©er des objets dans votre code. Tout est gÃ©rÃ© Â« plus haut Â» afin de centraliser la configuration, la maniÃ¨re dont l&#39;objet est crÃ©Ã©, etc.</p><p>Quelques avantages Ã  utiliser de l&#39;injection :</p><ul><li>RÃ©duction du code (les crÃ©ations d&#39;objets sont effectuÃ©es qu&#39;une seule fois et injectÃ©es automatiquement grÃ¢ce au typage).</li><li>RÃ©duction de la mÃ©moire, logique moins d&#39;instance d&#39;objet identique crÃ©er Ã  plusieurs endroits dans votre code.</li><li>Isolation entre la logique de l&#39;objet et votre code, vous n&#39;Ãªtes qu&#39;un consommateur de fonctionnalitÃ©s la logique peut-Ãªtre carrÃ©ment Ã©crite par quelqu&#39;un d&#39;autre, voir dans certains cas externalisÃ©s dans des librairies externes (Kotlin Native par exemple).</li><li>Etc.</li></ul><h3 id="koin" tabindex="-1">Koin <a class="header-anchor" href="#koin" aria-label="Permalink to &quot;Koin&quot;">â€‹</a></h3><p>Dans notre nous allons utiliser la librairie Koin, elle est complÃ¨tement Ã©crite en Kotlin, elle a comme avantage d&#39;Ãªtre simple Ã  utiliser avec trÃ¨s peut de code Ã  Ã©crire (et donc Ã  comprendre).</p><h3 id="concretement-ca-ressemble-a-quoi" tabindex="-1">ConcrÃ¨tement Ã§a ressemble Ã  quoi <a class="header-anchor" href="#concretement-ca-ressemble-a-quoi" aria-label="Permalink to &quot;ConcrÃ¨tement Ã§a ressemble Ã  quoi&quot;">â€‹</a></h3><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> appModule </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Inject dependencies for the MainViewModel (the only UI in this boilerplate)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    viewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MainViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Sample Remote Data Repository</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    single</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SampleRemoteRepository</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(createdAtStart </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SampleRemoteRemoteRepositoryImpl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Sample Local Data Repository</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    single</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SampleLocalRepository</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(createdAtStart </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SampleLocalRepositoryImpl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> remoteDataSourceModule </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // provided web components</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    single</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createOkHttpClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Fill property</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    single</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createWebService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SampleRemoteDataSource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), BuildConfig.REMOTE_URI) }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> moduleApp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> listOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(appModule, remoteDataSourceModule)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>L&#39;ensemble est, je pense, relativement parlant, mais regardons en dÃ©tail le <code>get()</code>, comme vous pouvez le voir celui-ci est prÃ©sent un peu partout dans la dÃ©claration de nos Ã©lÃ©ments Ã  injecter. Ce mot-clÃ© est <em>magique</em> il permet Ã  <a href="https://insert-koin.io/" target="_blank" rel="noreferrer">Koin</a> de dÃ©tecter le type de paramÃ¨tre attendu et d&#39;injecter automatiquement le bon objet.</p><p>Par exemple nous indiquons que <code>createWebService(client: OkHttpClient, url: String)</code>, automatiquement Koin va chercher dans les objets qu&#39;il connait ceux correspondant Ã  la signature (dans notre cas <code>single { createOkHttpClient() }</code>) et <code>BuildConfig.REMOTE_URI</code> Ã©tant la String attendu.</p><p>Dans le cas d&#39;un objet de notre vue, nous avons dans le mÃªme principe :</p><p><code>viewModel { MainViewModel(get(), get()) }</code> qui reprÃ©sente le View-Modele de notre Activity.</p><p>Celui-ci attend deux paramÃ¨tres :</p><p><code>MainViewModel(sampleRemoteRepository: SampleRemoteRepository, sampleLocalRepository: SampleLocalRepository)</code>.</p><p>CompliquÃ© ? Pas tellement, avec la pratique Ã§a vous semblera automatique. ğŸ˜Š</p><h2 id="modifier-le-package-Â«-sample-Â»" tabindex="-1">Modifier le package Â« sample Â» <a class="header-anchor" href="#modifier-le-package-Â«-sample-Â»" aria-label="Permalink to &quot;Modifier le package Â« sample Â»&quot;">â€‹</a></h2><p>Comme vous le savez, sur Android les applications doivent Ãªtre uniques Â« de maniÃ¨re cryptographique Â» une partie du test est basÃ© sur leur package. Nous allons donc faire en sorte de personnaliser le package afin de le rendre unique pour vous et votre tÃ©lÃ©phone.</p>`,50),h=s("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/3tULbe0wPmU",frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,-1),u=e(`<h2 id="changer-le-nom-de-l-application" tabindex="-1">Changer le nom de l&#39;application <a class="header-anchor" href="#changer-le-nom-de-l-application" aria-label="Permalink to &quot;Changer le nom de l&#39;application&quot;">â€‹</a></h2><p>Si vous regardez dans votre liste d&#39;application vous allez trouver une application nommÃ©e <code>Boilerplate - Koin - Retrofit</code>. Pour le changer, c&#39;est simple, il suffit d&#39;Ã©diter le fichier <code>strings.xml</code>.</p><p>âš ï¸ En parlant de ce fichier, celui-ci <em>doit</em> contenir l&#39;ensemble de vos textes (et Ã©videmment pas uniquement le nom de votre application).</p><h2 id="changer-la-configuration-de-l-api" tabindex="-1">Changer la configuration de l&#39;API <a class="header-anchor" href="#changer-la-configuration-de-l-api" aria-label="Permalink to &quot;Changer la configuration de l&#39;API&quot;">â€‹</a></h2><p>Centraliser la configuration dans une application est <em>essentiel</em> au-delÃ  de l&#39;organisation du code, c&#39;est essentiel pour que vous puissiez travailler en Ã©quipe, mais Ã©galement pour reprendre votre code sereinement dans quelques annÃ©es (eh ouiâ€¦). Dans notre application la configuration sera centralisÃ©e dans le fichier <code>build.gradle</code>.</p><p>Si vous regardez le fichier en question, vous allez trouver <code>buildConfigField</code> cette instruction nous permettra de dÃ©finir de la configuration propre Ã  l&#39;environnement (Prod, Dev, Staging, etc.). Bref c&#39;est gÃ©nial !</p><p>J&#39;ai donc initialisÃ© dans mon petit Boilerplate <code>REMOTE_URI</code> qui sera dans votre code Kotlin l&#39;URL de votre serveur distant.</p><h2 id="repository-kezako" tabindex="-1">Repository ? KÃ©zako !? <a class="header-anchor" href="#repository-kezako" aria-label="Permalink to &quot;Repository ? KÃ©zako !?&quot;">â€‹</a></h2><p>Contiens la logique autour de vos donnÃ©es. Elle expose au reste de l&#39;application une API (Interne) permettant de gÃ©rer la mise Ã  jour des donnÃ©es.</p><p>Cette Â« brique de code Â» va permettre d&#39;agrÃ©ger les diffÃ©rentes sources de donnÃ©es afin d&#39;Ãªtre utilisable simplement dans vos VueModel (ViewModel).</p><p>ğŸ›‘ N&#39;hÃ©sitez pas Ã  dÃ©couper autant qu&#39;il le faut votre logique dans diffÃ©rents repository ğŸ™</p><h3 id="localrepository" tabindex="-1">LocalRepository ? <a class="header-anchor" href="#localrepository" aria-label="Permalink to &quot;LocalRepository ?&quot;">â€‹</a></h3><p>Dans le code fourni en exemple, le <code>Local Repository</code> Â« simule Â» un repository qui accÃ¨derait Ã  des donnÃ©es Â« local Â» c&#39;est-Ã -dire dans votre tÃ©lÃ©phone (mÃ©moire interne par exemple).</p><h3 id="remoterepository" tabindex="-1">RemoteRepository ? <a class="header-anchor" href="#remoterepository" aria-label="Permalink to &quot;RemoteRepository ?&quot;">â€‹</a></h3><p>Dans le code fourni en exemple, le <code>Remote Repository</code> Â« simule Â» une interaction avec Â« l&#39;extÃ©rieur Â» de votre tÃ©lÃ©phone c&#39;est-Ã -dire dans notre cas <code>Internet</code> via un appel d&#39;API via le protocole HTTP.</p><h2 id="ajouter-une-nouvelle-route-d-api-distance" tabindex="-1">Ajouter une nouvelle route d&#39;API distance <a class="header-anchor" href="#ajouter-une-nouvelle-route-d-api-distance" aria-label="Permalink to &quot;Ajouter une nouvelle route d&#39;API distance&quot;">â€‹</a></h2><p>Ajouter une nouvelle route d&#39;API Ã  notre projet va se rÃ©sumer Ã  la modification de quelques fichiers. Ã€ premier vu Ã§a peut sembler fastidieux, mais vous allez rapidement voir que ce dÃ©coupage va nous permettre d&#39;organiser le code au mieux afin de le rendre maintenant dans la durÃ©e. Et finalement n&#39;est-ce pas le plus important ?</p><p>Je vais prendre un exemple simple, le souhaite ajouter une nouvelle route disponible sur <code>https://rest.ensembl.org/</code> dans mon projet. Au hasard la route <code>/info/rest?content-type=application/json</code>.</p><p>ğŸ¤”Je rappelle au passage que la finalitÃ© est de Â« RÃ©cupÃ©rer l&#39;information Â» du serveur, le faire transiter dans votre code, pour au final l&#39;afficher quelque part dans votre application.</p><h3 id="declarer-l-appel-http-dans-sampleremotedatasource" tabindex="-1">DÃ©clarer l&#39;appel HTTP dans SampleRemoteDataSource <a class="header-anchor" href="#declarer-l-appel-http-dans-sampleremotedatasource" aria-label="Permalink to &quot;DÃ©clarer l&#39;appel HTTP dans SampleRemoteDataSource&quot;">â€‹</a></h3><p>DÃ©clarer une mÃ©thode dans le fichier <code>sampleRemoteDataSource.kt</code>, ce fichier est une Interface, qui va Â« dÃ©clarer Â» l&#39;ensemble des mÃ©thodes HTTP appelable dans le code. La dÃ©claration de celles-ci est effectuÃ©e via des annotations (symbolisÃ© avec <code>@</code>). Dans notre cas le fichier contient actuellement :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@GET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;info/ping?content-type=application/json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@Headers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Content-type: application/json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PingResult</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Nous dÃ©clarons donc une mÃ©thode de type <code>GET</code> qui consommera un retour en JSON.</p><p>Nous allons ajouter la seconde mÃ©thode de la mÃªme faÃ§on</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@GET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;info/rest?content-type=application/json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@Headers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Content-type: application/json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> restInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RestResult</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Vous allez devoir crÃ©er une Data Class <code>RestResult</code> qui servira Ã  dÃ©serialser le retour de l&#39;API. Elle va ressembler Ã  :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RestResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> release: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ğŸ‘€Attention ğŸ‘€ ranger le fichier dans le bon dossier/package ! Ã€ savoir <code>data/models/RestResult</code>.</p><h4 id="comment-ca-fonctionne-en-deux-mots" tabindex="-1">Comment Ã§a fonctionne en deux mots ? <a class="header-anchor" href="#comment-ca-fonctionne-en-deux-mots" aria-label="Permalink to &quot;Comment Ã§a fonctionne en deux mots ?&quot;">â€‹</a></h4><p>DÃ©clarer une mÃ©thode dans une Interface pour permettre d&#39;appeler un WebService !? C&#39;est magique ? En rÃ©alitÃ© tout Ã§a est possible grace Ã  OkHTTP2, Retrofit, et l&#39;injection de dÃ©pendance. Pour les curieux, toute la logique est ici <code>src/main/java/com/boilerplate/app/di/remote_datasource_model.kt</code></p><h3 id="declarer-la-methode-dans-sampleremoterepository" tabindex="-1">DÃ©clarer la mÃ©thode dans SampleRemoteRepository <a class="header-anchor" href="#declarer-la-methode-dans-sampleremoterepository" aria-label="Permalink to &quot;DÃ©clarer la mÃ©thode dans SampleRemoteRepository&quot;">â€‹</a></h3><p>La premiÃ¨re Ã©tape Ã©tait la dÃ©claration dans l&#39;interface, c&#39;est chose faite. Maintenant nous allons dÃ©clarer notre mÃ©thode dans le <code>Repository</code>, donc dans la brique qui va appeler la source de donnÃ©es.</p><p>Nous allons donc tout simplement :</p><ul><li>Ajouter la dÃ©claration de la mÃ©thode dans l&#39;interface <code>SampleRemoteRepository</code> nommÃ©e infoRest.</li><li>ImplÃ©menter la mÃ©thode <code>infoRest</code> dans <code>SampleRemoteRemoteRepositoryImpl</code> afin de pouvoir appeler l&#39;API.</li></ul><h3 id="l-appeler-depuis-le-code" tabindex="-1">L&#39;appeler depuis le code <a class="header-anchor" href="#l-appeler-depuis-le-code" aria-label="Permalink to &quot;L&#39;appeler depuis le code&quot;">â€‹</a></h3><p>Pour tester (et uniquement pour tester), nous allons appeler la nouvelle mÃ©thode depuis la vue principale. La procÃ©dure va Ãªtre relativement simple :</p><ul><li>Ajout d&#39;une mÃ©thode dans <code>MainViewModel.kt</code><ul><li>La mÃ©thode doit implÃ©menter les states. (Chargement, et retour de la Â« string reÃ§u Â»)</li></ul></li><li>Appeler la mÃ©thode dÃ©clarÃ©e dans le MainViewModel depuis l&#39;activity. (ex <code>myViewModel.getRestInfomations()</code>).</li></ul><p>Dans l&#39;implÃ©mentation actuelle, je vous propose d&#39;afficher un <code>un Toast</code> lors de la rÃ©ception de la donnÃ©e.</p><h2 id="ajouter-une-nouvelle-activity" tabindex="-1">Ajouter une nouvelle Activity <a class="header-anchor" href="#ajouter-une-nouvelle-activity" aria-label="Permalink to &quot;Ajouter une nouvelle Activity&quot;">â€‹</a></h2><p>Maintenant que nous avons validÃ© que notre code fonctionne, nous allons pouvoir ajouter une nouvelle vue. Nous avons une nouvelle route <code>infoRest</code> qui pour l&#39;instant est inutilisÃ©e, nous allons crÃ©er une vue et le code associÃ© afin d&#39;afficher l&#39;information reÃ§ue du serveur.</p><h3 id="layout" tabindex="-1">Layout <a class="header-anchor" href="#layout" aria-label="Permalink to &quot;Layout&quot;">â€‹</a></h3><p>La premiÃ¨re Ã©tape va Ãªtre la crÃ©ation de la vue. Pour Ã§a crÃ©er un Layout XML comme nous avons dÃ©jÃ  pu le voir ensemble.</p><h3 id="code" tabindex="-1">Code <a class="header-anchor" href="#code" aria-label="Permalink to &quot;Code&quot;">â€‹</a></h3><p>Le minimum de code pour que votre activity fonctionne est le suivant :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> YourActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AppCompatActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    companion</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, YourActivity::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.java)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onCreate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(savedInstanceState: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Bundle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onCreate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(savedInstanceState)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        setContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(R.layout.activity_demo)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>ğŸ‘€ Comme toujours l&#39;organisation du code est une chose trÃ¨s importante, ne placez pas votre classe n&#39;importe oÃ¹. Mais dans un package dans <code>view</code> :</p><p><img src="`+p+'" alt="create package" loading="lazy"></p>',47),k=s("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/M1RJ1kQg7Hg",frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,-1),m=e(`<p>Si vous souhaitez plus de dÃ©tail, inspirer du code prÃ©sent dans le <code>MainActivity.kt</code> ou dans les exemples que nous avons Ã©voquÃ©s pendant le cours.</p><h4 id="getstartintent" tabindex="-1">getStartIntent ? <a class="header-anchor" href="#getstartintent" aria-label="Permalink to &quot;getStartIntent ?&quot;">â€‹</a></h4><p>Cette mÃ©thode a pour but de simplifier la lecture (et la navigation) entre les vues. Cette mÃ©thode est statique, elle sera appelÃ©e que vous souhaiterez appeler votre <code>activity</code> depuis une autre <code>vue</code> / <code>activity</code>. Elle retourne une <code>Intent</code> qui nous servira Ã  dÃ©marrer l&#39;activity souhaitÃ©e.</p><p><em>Exemple :</em></p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    startActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MainActivity.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Le but Ã©galement de crÃ©er des <code>getStartIntent</code> est de simplifier la gestion du passage des paramÃ¨tres. En effet, sur Android passer des paramÃ¨tres Ã  une activitÃ© se rÃ©sume Ã  les attacher Ã  l&#39;Intent. Centraliser la dÃ©claration, permet Ã©galement de centraliser cette logique.</p><p><em>Exemple :</em></p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">companion</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AGE_DU_CAPITPAINE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;AGE_DU_CAPITPAINE&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ageDuCapitaine: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, MainActivity::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.java).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            putExtra</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(FROM_HOME, ageDuCapitaine)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Pour rÃ©cupÃ©rer cette valeur.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ageDuCapitaine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> intent.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBooleanExtra</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(AGE_DU_CAPITPAINE, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">33</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="rendre-accessible-cette-vue-activity" tabindex="-1">Rendre accessible cette vue / activity <a class="header-anchor" href="#rendre-accessible-cette-vue-activity" aria-label="Permalink to &quot;Rendre accessible cette vue / activity&quot;">â€‹</a></h2><p>Maintenant que cette activity est crÃ©Ã©e, nous allons devoir la rendre Â« visible Â» par Android. Cette Ã©tape est relativement simple. Il suffit de laisser faire votre IDE pour lui faire autodÃ©clarer le bon XML dans le fichier <code>AndroidManifest.xml</code>.</p><p>Si vous souhaitez rÃ©aliser cette action Ã  la main. Il suffit d&#39;ajouter Â« dans / sous Â» l&#39;Ã©lÃ©ment application :</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">activity</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.boilerplate.app.view.main.MainActivity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>âš ï¸ Mais sÃ©rieusement, ne l&#39;ajoutez pas Ã  la main. Faite plutÃ´t alt entrÃ©e sur le nom de votre class dans l&#39;IDE l&#39;action vous sera proposÃ©e.</p><p><img src="`+o+`" alt="ajouter au manifeste" loading="lazy"></p><h3 id="creer-une-home" tabindex="-1">CrÃ©er une home <a class="header-anchor" href="#creer-une-home" aria-label="Permalink to &quot;CrÃ©er une home&quot;">â€‹</a></h3><p>En suivant le mÃªme principe que prÃ©cÃ©demment, crÃ©ez une Home avec deux boutons permettant d&#39;accÃ©der Ã  la <code>MainActivity</code> et Ã  <code>InfoRestActivity</code>.</p><p>Petit rappel, pour Â« attacher Â» une action de clique sur un bouton :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">btnMain.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setOnClickListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    startActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MainActivity.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">btnInfosRest.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setOnClickListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    startActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(InfoRestActivity.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="declarer-cette-home-comme-activity-principale-de-votre-application" tabindex="-1">DÃ©clarer cette home comme activity principale de votre application <a class="header-anchor" href="#declarer-cette-home-comme-activity-principale-de-votre-application" aria-label="Permalink to &quot;DÃ©clarer cette home comme activity principale de votre application&quot;">â€‹</a></h3><p>Un certain nombre de paramÃ¨tres autour des intent est modifiable directement dans <code>AndroidManifest.xml</code>, la dÃ©claration de <code>l&#39;intent</code> Ã  lancer au dÃ©marrage de l&#39;application est faite via :</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">intent-filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;android.intent.action.MAIN&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">category</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;android.intent.category.LAUNCHER&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">intent-filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>DÃ©placer <code>l&#39;intent filter</code> dans bloc correspondant Ã  votre activity.</p><h3 id="connecter-le-tout" tabindex="-1">Connecter le tout <a class="header-anchor" href="#connecter-le-tout" aria-label="Permalink to &quot;Connecter le tout&quot;">â€‹</a></h3><p>Votre application contient maintenant 3 activitÃ©s :</p><ul><li>Une home.</li><li>L&#39;activitÃ© permettant de connaitre la version du serveur. <code>infoRest</code></li><li>Une activitÃ© permettant de Â« rÃ©aliser des pings Â».</li></ul><p>Appeler les diffÃ©rends <code>getStartIntent()</code> depuis les bonnes vues.</p><p>Exemple :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> startMainActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(){</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    startActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MainActivity.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="utiliser-un-repository-depuis-une-nouvelle-activity" tabindex="-1">Utiliser un Repository depuis une nouvelle activity <a class="header-anchor" href="#utiliser-un-repository-depuis-une-nouvelle-activity" aria-label="Permalink to &quot;Utiliser un Repository depuis une nouvelle activity&quot;">â€‹</a></h2><p>Comme indiquÃ© prÃ©cÃ©demment, nous n&#39;allons pas directement appeler notre <code>Repository</code> directement depuis notre <code>Activity</code>.</p><div class="tip custom-block"><p class="custom-block-title">Petit rappel</p><p>Nous allons dÃ©couper notre logique en diffÃ©rentes parties :</p><ul><li>La logique de la vue va rester dans l&#39;Activity.</li><li>La logique des donnÃ©es de la vue va Ãªtre mise dans la partie <code>ViewModel</code>.</li><li>La logique Â« de rÃ©cupÃ©ration Â» des donnÃ©es va Ãªtre mise dans un <code>Repository</code>.</li></ul></div><p>CrÃ©er un ViewModel pour une <code>Activity</code> va se rÃ©sumer Ã  trois opÃ©rations :</p><ul><li>CrÃ©er une Class <code>YourActivityViewModel</code> et qui extend de <code>BaseViewModel()</code></li><li>DÃ©clarer votre <code>YourActivityViewModel</code> dans l&#39;activity en spÃ©cifiant que celui-ci sera automatiquement injectÃ©.</li><li>Le dÃ©clarer dans l&#39;injecteur de dÃ©pendances.</li></ul><h3 id="creation-de-votre-youractivityviewmodel" tabindex="-1">CrÃ©ation de votre <code>YourActivityViewModel</code> <a class="header-anchor" href="#creation-de-votre-youractivityviewmodel" aria-label="Permalink to &quot;CrÃ©ation de votre \`YourActivityViewModel\`&quot;">â€‹</a></h3><p>Cette Ã©tape est la premiÃ¨re, nous allons crÃ©er une Class qui contiendra la Â« logique Â» des donnÃ©es de la vue, le minimum que doit contenir cette classe est :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> YourActivityViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BaseViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> states </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MutableLiveData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ViewModelState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Vous dÃ©clarerez ici vos mÃ©thodes et variables nÃ©cessaires</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // au bon fonctionnement de votre application.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Vous voulez un exemple Â« plus grand Â» ?</p><p>Vous avez dans le projet un exemple de <code>ViewModel</code> un peu plus complet, c&#39;est le fichier <code>MainViewModel.kt</code> il est Ã©galement <a href="https://raw.githubusercontent.com/c4software/Android-Boilerplate-Koin-CoRoutines-OkHTTP/master/app/src/main/java/com/boilerplate/app/view/main/MainViewModel.kt" target="_blank" rel="noreferrer">accessible ici</a></p></div><h3 id="declarer-votre-viewmodel-dans-l-activity" tabindex="-1">DÃ©clarer votre ViewModel dans l&#39;activity <a class="header-anchor" href="#declarer-votre-viewmodel-dans-l-activity" aria-label="Permalink to &quot;DÃ©clarer votre ViewModel dans l&#39;activity&quot;">â€‹</a></h3><p>Pour Ã§a rien de bien compliquÃ©, il suffit d&#39;ajouter le code suivant :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myViewModel: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">YourActivityViewModel</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> by</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> viewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="danger custom-block"><p class="custom-block-title">Attention</p><p>Ne pas mettre le code n&#39;importe oÃ¹. Nous avons ici un <strong>attribut de class</strong>.</p></div><h3 id="declaration-dans-l-injecteur-de-dependance" tabindex="-1">DÃ©claration dans l&#39;injecteur de dÃ©pendance <a class="header-anchor" href="#declaration-dans-l-injecteur-de-dependance" aria-label="Permalink to &quot;DÃ©claration dans l&#39;injecteur de dÃ©pendance&quot;">â€‹</a></h3><p>Si vous souhaitez que Ã§a fonctionne, vous devez dire Ã  votre code comment le <code>by viewModel()</code> va Ãªtre rÃ©solu. Pour Ã§a nous devons indiquer Ã  notre injecteur de dÃ©pendance comment crÃ©er cette dÃ©pendance, cette dÃ©claration est Ã  faire dans le fichier <code>app_module.kt</code> (il se trouve dans le package <code>.di</code>).</p><p>Vous devez donc ajouter dans le <code>appModule</code> le code suivant :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    viewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">YourActivityViewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ğŸ¤“ Bien Ã©videmment, vous ajoutez le code Ã  la suite du <code>viewModel</code> dÃ©jÃ  prÃ©sent ğŸ¤“</p>`,46),g=[c,h,u,k,m];function E(v,y,b,f,F,C){return n(),a("div",null,g)}const B=i(d,[["render",E]]);export{A as __pageData,B as default};
